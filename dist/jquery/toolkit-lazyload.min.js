/*!
 * Titon Toolkit v1.1.0-rc.1
 * Copyright 2010-2013, The Titon Project - http://titon.io
 * BSD-2 - https://github.com/titon/toolkit/blob/master/license.md
 */
!function(a){"use strict";Toolkit.LazyLoad=Toolkit.Component.create(function(a,b){this.component="LazyLoad",this.version="0.0.0",this.options=this.setOptions(Toolkit.LazyLoad.options,b),this.elements=this.setElement(a,this.options),this.isLoaded=!1,this.loaded=0,this.initialize()}),Toolkit.LazyLoad.options={forceLoad:!1,delay:1e4,threshold:150,throttle:50,context:null};var b=Toolkit.LazyLoad.prototype;b.initialize=function(){a(this.options.context||window).on({scroll:a.throttle(this.load.bind(this),this.options.throttle),resize:a.throttle(this.load.bind(this),this.options.throttle)}),a(function(){this.load(),this.options.forceLoad&&window.setTimeout(this.loadAll.bind(this),this.options.delay)}.bind(this)),this.fireEvent("init")},b.inViewport=function(b){var c=a(window),d=this.options.threshold,e=c.scrollTop(),f=c.scrollLeft(),g=a(b).offset();return g.top>=e-d&&g.top<=e+c.height()+d&&g.left>=f-d&&g.left<=f+c.width()+d},b.load=function(){return this.isLoaded?!1:this.loaded===this.elements.length?(this.shutdown(),!1):(this.elements.each(function(a,b){b&&this.inViewport(b)&&this.show(b,a)}.bind(this)),this.fireEvent("load"),!0)},b.loadAll=function(){return this.isLoaded?!1:(this.elements.each(function(a,b){this.show(b,a)}.bind(this)),this.fireEvent("loadAll"),this.shutdown(),!0)},b.show=function(b,c){return b=a(b),b.removeClass(this.elements.selector.substr(1)),b.find("img").each(function(){var b=a(this),c=b.data("lazyload");c&&b.attr("src",c)}),this.elements.splice(c,1,null),this.loaded++,this.fireEvent("show",b),this},b.shutdown=function(){return this.isLoaded=!0,a(this.options.context||window).off({scroll:this.load.bind(this),resize:this.load.bind(this)}),this.fireEvent("shutdown"),this},a.fn.lazyLoad=function(b){var c=new Toolkit.LazyLoad(this,b);return this.each(function(){a(this).addData("toolkit.lazyload",c)})}}(jQuery);