/*!
 * Titon Toolkit v1.1.0
 * Copyright 2010-2014, The Titon Project - http://titon.io
 * BSD-2 - https://github.com/titon/toolkit/blob/master/license.md
 */
!function(a){"use strict";Toolkit.LazyLoad=Toolkit.Component.extend(function(b,c){b=a(b),this.component="LazyLoad",this.version="1.0.0",this.options=c=this.setOptions(c,b),this.container="auto"===b.css("overflow")?b:a(window),this.elements=b.find(".lazy-load"),this.element=null,this.isLoaded=!1,this.loaded=0;var d=a.throttle(this.load.bind(this),c.throttle);this.events={"scroll container":d,"resize window":d,"ready document":"onReady"},this.enable(),this.fireEvent("init")},{inViewport:function(b){b=a(b);var c=this.container,d=this.options.threshold,e=c.height(),f=c.width(),g=c.scrollTop(),h=c.scrollLeft(),i=c[0]!==window?b.position():b.offset();return b.is(":visible")&&i.top>=g-d&&i.top<=g+e+d&&i.left>=h-d&&i.left<=h+f+d},load:function(){if(!this.isLoaded){if(this.loaded===this.elements.length)return void this.shutdown();this.elements.each(function(a,b){b&&this.inViewport(b)&&this.show(b,a)}.bind(this)),this.fireEvent("load")}},loadAll:function(){this.isLoaded||(this.elements.each(function(a,b){this.show(b,a)}.bind(this)),this.fireEvent("loadAll"),this.shutdown())},show:function(b,c){b=a(b),b.removeClass("lazy-load"),this.element=b,b.find("img").each(function(){var b,c=a(this);Toolkit.isRetina&&(b=c.data("src-retina")),b||(b=c.data("src")),b&&c.attr("src",b)}),this.elements.splice(c,1,null),this.loaded++,this.fireEvent("show",b)},shutdown:function(){this.isLoaded=!0,this.disable(),this.fireEvent("shutdown")},onReady:function(){this.load(),this.options.forceLoad&&setTimeout(this.loadAll.bind(this),this.options.delay)}},{forceLoad:!1,delay:1e4,threshold:150,throttle:50}),Toolkit.createComponent("lazyLoad",function(a){return new Toolkit.LazyLoad(this,a)})}(jQuery);