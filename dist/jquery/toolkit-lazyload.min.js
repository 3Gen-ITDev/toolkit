/*!
 * Titon Toolkit v1.1.0
 * Copyright 2010-2014, The Titon Project - http://titon.io
 * BSD-2 - https://github.com/titon/toolkit/blob/master/license.md
 */
!function(a){"use strict";Toolkit.LazyLoad=Toolkit.Component.extend(function(b,c){this.component="LazyLoad",this.version="1.0.0",this.options=c=this.setOptions(c),this.elements=a(b),this.element=null,this.isLoaded=!1,this.loaded=0,a(c.context||window).on({scroll:a.throttle(this.load.bind(this),c.throttle),resize:a.throttle(this.load.bind(this),c.throttle)}),this.enable(),this.fireEvent("init"),a(function(){this.load(),c.forceLoad&&setTimeout(this.loadAll.bind(this),c.delay)}.bind(this))},{inViewport:function(b){var c=a(window),d=this.options.threshold,e=c.scrollTop(),f=c.scrollLeft(),g=a(b).offset();return a(b).is(":visible")&&g.top>=e-d&&g.top<=e+c.height()+d&&g.left>=f-d&&g.left<=f+c.width()+d},load:function(){return this.isLoaded?!1:this.loaded===this.elements.length?(this.shutdown(),!1):(this.elements.each(function(a,b){b&&this.inViewport(b)&&this.show(b,a)}.bind(this)),this.fireEvent("load"),!0)},loadAll:function(){return this.isLoaded?!1:(this.elements.each(function(a,b){this.show(b,a)}.bind(this)),this.fireEvent("loadAll"),this.shutdown(),!0)},show:function(b,c){b=a(b),b.removeClass(this.elements.selector.substr(1)),this.element=b,b.find("img").each(function(){var b,c=a(this);Toolkit.isRetina&&(b=c.data("src-retina")),b||(b=c.data("src")),b&&c.attr("src",b)}),this.elements.splice(c,1,null),this.loaded++,this.fireEvent("show",b)},shutdown:function(){this.isLoaded=!0,a(this.options.context||window).off({scroll:this.load.bind(this),resize:this.load.bind(this)}),this.fireEvent("shutdown")}},{forceLoad:!1,delay:1e4,threshold:150,throttle:50}),Toolkit.createComponent("lazyLoad",function(a){return new Toolkit.LazyLoad(this,a)},!0)}(jQuery);