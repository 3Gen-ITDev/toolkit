/*!
 * Titon Toolkit v1.0.4
 * Copyright 2010-2013, The Titon Project - http://titon.io
 * BSD-2 - https://github.com/titon/toolkit/blob/master/license.md
 */
!function(a){"use strict";Toolkit.Tabs=Toolkit.Component.create(function(b,c){this.options=this.setOptions(Toolkit.Tabs.options,c),this.element=this.setElement(b,this.options),this.nav=null,this.sections=[],this.tabs=[],this.previousIndex=0,this.currentIndex=0,this.cache={},this.enabled=!0,this.initialize=function(){var b=this.options;b.cookie||(this.options.cookie=b.cookie=this.element.attr("id")),this.nav=this.element.find(b.navElement),this.tabs=this.nav.find("ul > li > a"),this.tabs.each(function(b){a(this).data("index",b).removeClass(Toolkit.options.isPrefix+"active")}),this.sections=this.element.find(b.sectionsElement),this.sections.conceal(),this.tabs.on("click"===b.mode?"click":"mouseover",this.__show.bind(this)),"hover"===b.mode&&b.preventDefault&&this.tabs.on("click",function(a){a.preventDefault()}),this.fireEvent("init");var c=b.defaultIndex;if(b.persistState){var d="toolkit.tabs."+b.cookie,e=document.cookie.match("(?:^|;)\\s*"+d.replace(/[\-\.\+\*]/g,"\\$&")+"=([^;]*)");e&&e.length&&(c=decodeURIComponent(e[1]))}else if(b.loadFragment&&location.hash){var f=this.tabs.filter(function(){return a(this).attr("href")===location.hash});f.length&&(c=f.item(0).data("index"))}this.tabs[c]||(c=0),this.jump(c)},this.hide=function(){return this.sections.conceal(),this.fireEvent("hide",this.node),this},this.jump=function(a){return this.tabs[a]&&this.show(this.tabs[a]),this},this.show=function(b){b=a(b);var c=b.data("index"),d=this.sections.item(c),e=this.readValue(b,this.options.getUrl);if(this.options.ajax&&e&&"#"!==e.substr(0,1)&&!this.cache[e]&&this.requestData("tabs",e,function(){d.html(this._loadingTemplate("tabs")).addClass(Toolkit.options.isPrefix+"loading")},function(a){this.cache[e]=!0,d.html(a).removeClass(Toolkit.options.isPrefix+"loading"),this.fireEvent("load",a)},function(){d.html(this._errorTemplate("tabs")).removeClass(Toolkit.options.isPrefix+"loading").addClass(Toolkit.options.hasPrefix+"failed")}),this.nav.find("ul > li").removeClass(Toolkit.options.isPrefix+"active"),c===this.currentIndex&&this.options.collapsible?d.is(":shown")?d.conceal():(b.parent().addClass(Toolkit.options.isPrefix+"active"),d.reveal()):(this.hide(),b.parent().addClass(Toolkit.options.isPrefix+"active"),d.reveal()),this.options.persistState){var f="toolkit.tabs."+this.options.cookie+"="+encodeURIComponent(c),g=new Date;g.setTime(g.getTime()+1e3*60*60*24*this.options.cookieDuration),f+="; expires="+g.toUTCString(),f+="; path=/",document.cookie=f}return this.previousIndex=this.currentIndex,this.currentIndex=c,this.fireEvent("show",b),this.node=b,this},this.__show=function(b){(this.options.preventDefault||this.options.ajax&&"#"!==a(b.target).attr("href").substr(0,1))&&b.preventDefault(),this.enabled&&this.show(b.target)},this.element.length&&this.initialize()}),Toolkit.Tabs.options={mode:"click",ajax:!0,collapsible:!1,defaultIndex:0,persistState:!1,preventDefault:!0,loadFragment:!0,cookie:null,cookieDuration:30,getUrl:"href",navElement:".tabs-nav",sectionsElement:".tabs-section"},a.fn.tabs=function(b){return this.each(function(){a(this).addData("toolkit.tabs",function(){return new Toolkit.Tabs(this,b)})})}}(jQuery);