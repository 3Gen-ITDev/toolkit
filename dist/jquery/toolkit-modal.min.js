/*!
 * Titon Toolkit v1.1.0
 * Copyright 2010-2014, The Titon Project - http://titon.io
 * BSD-2 - https://github.com/titon/toolkit/blob/master/license.md
 */
!function(a){"use strict";Toolkit.Modal=Toolkit.Component.extend(function(b,c){var d,e;this.component="Modal",this.version="1.1.0",this.options=c=this.setOptions(c),this.element=d=this.createElement(),this.elementBody=d.find(c.contentElement),this.nodes=b=a(b),this.node=null,this.blackout=null,this.drag=null,this.cache={},this.events=e={},c.fullScreen&&(d.addClass(Toolkit.options.isPrefix+"fullscreen"),c.draggable=!1),c.blackout&&(this.blackout=Toolkit.Blackout.factory(),c.stopScroll&&this.blackout.element.on("hide.toolkit.blackout",function(b,c){c&&a("body").removeClass("no-scroll")})),e["clickout element"]="onHide",e["clickout nodes"]="onHide",e["keydown window"]="onKeydown",e["click "+b.selector]="onShow",e["click element "+c.closeEvent]="onHide",e["click element "+c.submitEvent]="onSubmit",this.enable(),this.fireEvent("init")},{hide:function(){this.element.conceal(),this.blackout&&this.blackout.hide(),this.fireEvent("hide")},position:function(b){b!==!0&&(this.blackout&&this.blackout.hideLoader(),this.elementBody.html(b),this.fireEvent("load",b),this.element.reveal(),this.options.fullScreen&&this.element.find(this.options.contentElement).css("min-height",a(window).height()),this.fireEvent("show"))},show:function(b,c){var d=this.options,e=d.ajax;c?e=!1:b&&(this.node=b=a(b),e=this.readOption(b,"ajax"),c=this.readValue(b,this.readOption(b,"getContent"))||b.attr("href"),c&&c.match(/^#[a-z0-9_\-\.:]+$/i)&&(c=a(c).html(),e=!1)),c&&(this.blackout&&this.blackout.show(),d.stopScroll&&a("body").addClass("no-scroll"),e?this.cache[c]?this.position(this.cache[c]):this.requestData(c):this.position(c))},onHide:function(a){a.preventDefault(),this.hide()},onKeydown:function(a){27===a.keyCode&&this.element.is(":shown")&&this.hide()},onShow:function(a){a.preventDefault(),this.show(a.currentTarget)},onSubmit:function(b){b.preventDefault();var c=a(b.target),d=this.elementBody.find("form:first");if(d){this.fireEvent("submit",[c,d]);var e={url:d.attr("action"),type:(d.attr("method")||"post").toUpperCase()};window.FormData?(e.processData=!1,e.contentType=!1,e.data=new FormData(d[0])):e.data=d.serialize(),this.requestData(e)}}},{animation:"fade",ajax:!0,draggable:!1,blackout:!0,fullScreen:!1,stopScroll:!0,getContent:"data-modal",contentElement:".modal-inner",closeElement:".modal-close",closeEvent:".modal-event-close",submitEvent:".modal-event-submit",template:'<div class="modal"><div class="modal-outer"><div class="modal-handle"><div class="modal-inner"></div><button type="button" class="modal-close modal-event-close"><span class="x"></span></button></div></div></div>'}),Toolkit.createComponent("modal",function(a){return new Toolkit.Modal(this,a)},!0)}(jQuery);