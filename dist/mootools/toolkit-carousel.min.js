/*!
 * Titon Toolkit v1.1.0-alpha
 * Copyright 2010-2013, The Titon Project - http://titon.io
 * BSD-2 - https://github.com/titon/toolkit/blob/master/license.md
 */
!function(){"use strict";Toolkit.Carousel=new Class({Extends:Toolkit.Component,Binds:["next","prev","start","stop","resize","__cycle","__jump"],stopped:!1,itemsWrapper:null,itemsList:null,items:[],tabsWrapper:null,tabs:[],prevButton:null,nextButton:null,previousIndex:0,currentIndex:0,timer:null,options:{animation:"slide",duration:5e3,autoCycle:!0,stopOnHover:!0,itemsElement:".carousel-items",itemElement:"li",tabsElement:".carousel-tabs",tabElement:"a",nextElement:".carousel-next",prevElement:".carousel-prev",template:!1,onStart:null,onStop:null,onCycle:null,onJump:null},initialize:function(a,b){if(this.parent(b),this.setElement(a),this.element){if(b=this.options,this.itemsWrapper=this.element.getElement(b.itemsElement),this.itemsWrapper&&(this.itemsList=this.itemsWrapper.getChildren("ul, ol"),this.items=this.itemsWrapper.getElements(b.itemElement)),this.tabsWrapper=this.element.getElement(b.tabsElement),this.tabsWrapper&&(this.tabs=this.tabsWrapper.getElements(b.tabElement)),this.nextButton=this.element.getElement(b.nextElement),this.prevButton=this.element.getElement(b.prevElement),this.items.length<=1)return this.tabsWrapper.hide(),this.nextButton.hide(),this.prevButton.hide(),void 0;switch(b.animation){case"fade":this.items[0].reveal();break;case"slide":this.itemsList.setStyle("width",100*this.items.length+"%"),this.items.setStyle("width",100/this.items.length+"%")}this.tabs.forEach(function(a,b){a.set("data-index",b)}),window.addEvent("keydown",function(a){switch(["up","down","left","right"].contains(a.key)&&a.preventDefault(),a.key){case"up":this.jump(0);break;case"down":this.jump(-1);break;case"left":this.prev();break;case"right":this.next()}}.bind(this)),this.bindEvents(),this.fireEvent("init")}},bindEvents:function(){return this.element?(this.options.stopOnHover&&this.element.addEvent("mouseenter",this.stop).addEvent("mouseleave",this.start),this.element.addEvent("swipe",function(a){"left"===a.direction&&this.next()}.bind(this)).addEvent("swipe",function(a){"right"===a.direction&&this.prev()}.bind(this)),this.tabs.length&&this.tabs.addEvent("click",this.__jump),this.nextButton&&this.nextButton.addEvent("click",this.next),this.prevButton&&this.prevButton.addEvent("click",this.prev),this.start().reset(),this):this},jump:function(a){switch(a>=this.items.length?a=0:0>a&&(a=this.items.length-1),this.previousIndex=this.currentIndex,this.currentIndex=a,this.tabs.length&&(this.tabs.removeClass(Toolkit.options.isPrefix+"active"),this.tabs[a]&&this.tabs[a].addClass(Toolkit.options.isPrefix+"active")),this.options.animation){case"fade":this.items.removeClass("show"),this.items[a].reveal();break;case"slide-up":this.itemsList.setStyle("top",-(100*a)+"%");break;default:this.itemsList.setStyle("left",-(100*a)+"%")}return this.reset(),this.fireEvent("jump",a),this},next:function(){return this.jump(this.currentIndex+1),this},prev:function(){return this.jump(this.currentIndex-1),this},reset:function(){return this.options.autoCycle&&(clearInterval(this.timer),this.timer=setInterval(this.__cycle,this.options.duration)),this},start:function(){return this.element.removeClass(Toolkit.options.isPrefix+"stopped"),this.stopped=!1,this.fireEvent("start"),this},stop:function(){return this.element.addClass(Toolkit.options.isPrefix+"stopped"),this.stopped=!0,this.fireEvent("stop"),this},__cycle:function(){this.enabled&&(this.stopped||(this.fireEvent("cycle"),this.next()))},__jump:function(a){a.preventDefault(),this.enabled&&this.jump(a.target.get("data-index")||0)}}),Element.implement("carousel",function(a){return this.$carousel||(this.$carousel=new Toolkit.Carousel(this,a)),this})}();