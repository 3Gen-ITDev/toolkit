/*!
 * Titon Toolkit v1.2.0
 * Copyright 2010-2014, The Titon Project - http://titon.io
 * BSD-2 - https://github.com/titon/toolkit/blob/master/license.md
 */
!function(){"use strict";Toolkit.Tabs=new Class({Extends:Toolkit.Component,nav:null,sections:[],tabs:[],index:0,options:{ajax:!0,collapsible:!1,defaultIndex:0,persistState:!1,preventDefault:!0,loadFragment:!0,cookie:null,cookieDuration:30,getUrl:"href",navElement:".tabs-nav",sectionElement:".tabs-section",template:!1},initialize:function(a,b){this.parent(b),this.element=a,this.options=b=this.inheritOptions(this.options,a),b.cookie||(b.cookie=a.get("id")),this.nav=a.getElement(b.navElement),this.tabs=this.nav.getElements("ul > li > a"),this.tabs.each(function(a,b){a.set("data-index",b).removeClass(Toolkit.options.isPrefix+"active")}),this.sections=a.getElements(b.sectionElement),this.sections.conceal(),this.events[b.mode+" tabs"]="onShow","click"!==b.mode&&b.preventDefault&&(this.events["click tabs"]=function(a){a.preventDefault()}),this.enable(),this.fireEvent("init");var c=b.defaultIndex;if(b.persistState&&(c=Number.from(Cookie.read("toolkit.tabs."+b.cookie))),!c&&b.loadFragment&&location.hash){var d=this.tabs.filter(function(a){return a.get("href")===location.hash});d[0]&&(c=d[0].get("data-index"))}c&&this.tabs[c]||(c=0),this.jump(c)},hide:function(){return this.sections.conceal(),this.fireEvent("hide",this.node),this},jump:function(a){return this.show(this.tabs[Number.from(a).bound(this.tabs.length)])},show:function(a){var b=a.get("data-index"),c=this.sections[b],d=this.options,e=Toolkit.options.isPrefix,f=this.readOption(a,"ajax"),g=this.readValue(a,this.readOption(a,"getUrl"));return f&&g&&"#"!==g.substr(0,1)&&!this.cache[g]&&this.requestData(g,function(){c.set("html",this._loadingTemplate()).addClass(e+"loading")}.bind(this),function(a){this.cache[g]=!0,this.fireEvent("load",a),c.set("html",a).removeClass(e+"loading")}.bind(this),function(){c.set("html",this._errorTemplate()).removeClass(e+"loading").addClass(Toolkit.options.hasPrefix+"failed")}.bind(this)),this.nav.getElements("ul > li").removeClass(e+"active"),b===this.index&&d.collapsible?c.isVisible()?c.conceal():(a.getParent().addClass(e+"active"),c.reveal()):(this.hide(),a.getParent().addClass(e+"active"),c.reveal()),d.persistState&&Cookie.write("toolkit.tabs."+d.cookie,b,{duration:d.cookieDuration}),this.index=b,this.node=a,this.fireEvent("show",a),this},onShow:function(a){(this.options.preventDefault||this.options.ajax&&"#"!==a.target.get("href").substr(0,1))&&a.preventDefault(),this.show(a.target)}}),Toolkit.createComponent("tabs",function(a){return new Toolkit.Tabs(this,a)})}();