/*!
 * Titon Toolkit v1.2.2
 * Copyright 2010-2014, The Titon Project - http://titon.io
 * BSD-2 - https://github.com/titon/toolkit/blob/master/license.md
 */
!function(){"use strict";Toolkit.Tooltip=new Class({Extends:Toolkit.Component,Binds:["onFollow"],elementHead:null,elementBody:null,options:{delegate:".js-tooltip",mode:"hover",ajax:!1,follow:!1,position:"top-center",showLoading:!0,showTitle:!0,getTitle:"title",getContent:"data-tooltip",mouseThrottle:50,xOffset:0,yOffset:0,delay:0,titleElement:".tooltip-head",contentElement:".tooltip-body",template:'<div class="tooltip"><div class="tooltip-inner"><div class="tooltip-head"></div><div class="tooltip-body"></div></div><div class="tooltip-arrow"></div></div>'},runtime:{},initialize:function(a,b){this.parent(b),this.nodes=a,this.createElement(),b=this.options,this.elementHead=this.element.getElement(b.titleElement),this.elementBody=this.element.getElement(b.contentElement),this.element.removeClass(b.className);var c="data-"+this.className()+"-title";this.nodes.each(function(a){a.setProperty(c,a.get("title")).removeProperty("title")}),"title"===b.getTitle&&(b.getTitle=c);var d={};"click"===b.mode?(d["clickout element"]="hide",d["clickout "+b.delegate]="hide"):d["mouseleave "+b.delegate]="hide",d[b.mode+" "+b.delegate]="onShow",this.events=d,this.enable(),this.fireEvent("init")},hide:function(){var a=this.element.get("data-new-position")||this.runtime.position||this.options.position,b=this.runtime.className||this.options.className;return this.runtime={},this.element.removeClass(a).removeClass(b).removeProperty("data-mew-position"),this.parent()},position:function(a,b){var c=Object.keys(this.runtime).length?this.runtime:this.options;if(a===!0)return this;if(this.element.addClass(c.position).addClass(c.className),b=b||this.readValue(this.node,c.getTitle),b&&c.showTitle?this.elementHead.set("html",b).show():this.elementHead.hide(),a?this.elementBody.set("html",a).show():this.elementBody.hide(),this.fireEvent("load",a),c.follow){var d="mousemove:throttle("+c.mouseThrottle+")";this.node.removeEvent(d,this.onFollow).addEvent(d,this.onFollow),this.fireEvent("show")}else this.element.positionTo(c.position,this.node,{left:c.xOffset,top:c.yOffset}),window.setTimeout(function(){this.element.reveal(),this.fireEvent("show")}.bind(this),c.delay||0);return this},show:function(a,b,c){var d;return a?(this.node=a,this.runtime=d=this.inheritOptions(this.options,a),b=b||this.readValue(a,d.getContent)):this.runtime=d=this.options,b?(d.ajax?this.cache[b]?this.position(this.cache[b],c):(d.showLoading&&this.position(Toolkit.messages.loading),this.requestData(b)):this.position(b,c),this):this},onFollow:function(a){a.preventDefault();var b=this.runtime;this.element.positionTo(b.position,a,{left:b.xOffset,top:b.yOffset},!0).reveal()}}),Toolkit.createComponent("tooltip",function(a){return new Toolkit.Tooltip(this,a)},!0)}();