/*!
 * Titon Toolkit v1.0.1
 * Copyright 2010-2013, The Titon Project - http://titon.io
 * BSD-2 - https://github.com/titon/toolkit/blob/master/license.md
 */
!function(){"use strict";Toolkit.Pin=new Class({Extends:Toolkit.Component,Binds:["__resize","__scroll"],viewport:null,elementSize:null,parentSize:null,elementTop:null,options:{animation:"",location:"right",xOffset:0,yOffset:0,throttle:50,fixed:!1,calculate:!1,context:null,template:!1,onScroll:null,onResize:null},initialize:function(a,b){this.parent(b),this.setElement(a),this.element&&(this.element.addClass(Toolkit.options.vendor+"pin"),this.elementTop=this.element.getStyle("top").toInt(),this.bindEvents(),this.fireEvent("init"))},bindEvents:function(){return window.addEvent("scroll:throttle("+this.options.throttle+")",this.__scroll).addEvent("resize:throttle("+this.options.throttle+")",this.__resize).addEvent("domready",this.__resize),this},calculate:function(){return this.viewport=window.getSize(),this.elementSize=this.element.getCoordinates(),this.parentSize=this.element.getParent(this.options.context).getCoordinates(),this},__resize:function(){this.calculate(),this.parentSize.height>this.elementSize.height?this.enable():this.disable(),this.fireEvent("resize")},__scroll:function(){if(this.options.calculate&&this.calculate(),this.enabled&&this.isVisible()){var a=this.options,b=a.fixed,c=this.elementSize,d=this.elementTop,e=this.parentSize,f=window.getScroll(),g={},h=a.xOffset,i=0;if(f.y<e.top)return this.element.removeProperty("style").removeClass(Toolkit.options.isPrefix+"pinned"),void 0;var j=f.y+c.height,k=e.height+e.top;b?j>=k?(i="auto",g.position="absolute",g.bottom=0):(g.position="fixed",g.bottom="auto"):(g.position="absolute",i+=j>=k?e.height-c.height:f.y-e.top+a.yOffset,d&&d>i&&(i=d)),g[a.location]=h,g.top=i,this.element.setStyles(g).addClass(Toolkit.options.isPrefix+"pinned"),this.fireEvent("scroll")}}}),Element.implement("pin",function(a){return this.$pin||(this.$pin=new Toolkit.Pin(this,a)),this})}();