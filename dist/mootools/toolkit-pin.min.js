/*!
 * Titon Toolkit v1.2.2
 * Copyright 2010-2014, The Titon Project - http://titon.io
 * BSD-2 - https://github.com/titon/toolkit/blob/master/license.md
 */
!function(){"use strict";Toolkit.Pin=new Class({Extends:Toolkit.Component,Binds:["onResize","onScroll"],viewport:null,elementSize:null,parentSize:null,elementTop:null,active:!0,options:{animation:"",location:"right",xOffset:0,yOffset:0,throttle:50,fixed:!1,calculate:!1,context:null,template:!1},initialize:function(a,b){this.parent(b),this.element=a,this.options=this.inheritOptions(this.options,a),a.addClass(Toolkit.options.vendor+"pin").addClass(b.animation),this.elementTop=a.getStyle("top").toInt();var c,d=this.options.throttle;this.events=c={"ready document":"onResize"},c["scroll:throttle("+d+") window"]="onScroll",c["resize:throttle("+d+") window"]="onResize",this.enable(),this.fireEvent("init")},calculate:function(){return this.viewport=window.getSize(),this.elementSize=this.element.getCoordinates(),this.parentSize=this.element.getParent(this.options.context).getCoordinates(),this.active=this.element.isVisible()&&this.parentSize.height>this.elementSize.height,this},pin:function(){if(this.options.calculate&&this.calculate(),this.active){var a=this.options,b=a.fixed,c=this.elementSize,d=this.elementTop,e=this.parentSize,f=window.getScroll(),g={},h=a.xOffset,i=0;if(f.y<e.top)return void this.element.removeProperty("style").removeClass(Toolkit.options.isPrefix+"pinned");var j=f.y+c.height,k=e.height+e.top;b?j>=k?(i="auto",g.position="absolute",g.bottom=0):(g.position="fixed",g.bottom="auto"):(g.position="absolute",i+=j>=k?e.height-c.height:f.y-e.top+a.yOffset,d&&d>i&&(i=d)),g[a.location]=h,g.top=i,this.element.setStyles(g).addClass(Toolkit.options.isPrefix+"pinned"),this.fireEvent("scroll")}},onResize:function(){this.calculate(),this.pin(),this.fireEvent("resize")},onScroll:function(){this.pin(),this.fireEvent("scroll")}}),Toolkit.createComponent("pin",function(a){return new Toolkit.Pin(this,a)})}();