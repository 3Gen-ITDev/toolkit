/*!
 * Titon Toolkit v1.0.2
 * Copyright 2010-2013, The Titon Project - http://titon.io
 * BSD-2 - https://github.com/titon/toolkit/blob/master/license.md
 */
!function(a){"use strict";a.Toolkit={version:"1.0.2",build:"hpc1rkbq",options:{vendor:"",isPrefix:"is-",hasPrefix:"has-"},messages:{loading:"Loading...",error:"An error has occurred!"},isTouch:!!("ontouchstart"in a)},Element.implement({toolkit:function(a){return this["$"+a]||null},reveal:function(){return this.swapClass("hide","show")},conceal:function(){return this.swapClass("show","hide")},isShown:function(){return"hidden"!==this.getStyle("visibility")},positionTo:function(a,b,c,d){a=a.hyphenate().split("-");var e={y:a[0],x:a[1]},f=c||{left:0,top:0},g=0,h=0,i=this.getDimensions({computeSize:!0,styles:["padding","border","margin"]});if("domevent"===typeOf(b))f.left+=b.page.x,f.top+=b.page.y;else{var j=b.getPosition();f.left+=j.x,f.top+=j.y,g=b.getHeight(),h=b.getWidth()}return"top"===e.y?f.top-=i.totalHeight:"bottom"===e.y?f.top+=g:"center"===e.y&&(f.top-=Math.round(i.totalHeight/2-g/2)),"left"===e.x?f.left-=i.totalWidth:"right"===e.x?f.left+=h:"center"===e.x&&(f.left-=Math.round(i.totalWidth/2-h/2)),d&&("center"===e.y&&("left"===e.x?f.left-=15:"right"===e.x&&(f.left+=15)),"center"===e.x&&("top"===e.y?f.top-=10:"bottom"===e.y&&(f.top+=20))),this.setStyles(f)}}),Elements.implement({toolkit:function(a){var b="$"+a,c=[];return this.each(function(a){a[b]&&c.push(a[b])}),1===c.length&&c[0]?c[0]:c}}),Array.implement({chunk:function(a){var b=this;return[].concat.apply([],b.map(function(c,d){return d%a?[]:[b.slice(d,d+a)]}))}}),Function.implement({debounce:function(a){var b,c=this;return function(){var d=this,e=arguments;clearTimeout(b),b=setTimeout(function(){c.apply(d,e),b=null},a||150)}}}),Element.Properties.html.set=function(a){var b=typeOf(a);return"element"===b?(this.innerHTML="",this.appendChild(a),this):("string"===b&&"#"===a.substr(0,1)?a=document.getElement(a).get("html"):"array"===b&&(a=a.join("")),this.innerHTML=a,this)}}(window);
!function(){"use strict";Toolkit.Component=new Class({Implements:[Events,Options],Binds:["__show","__hide","position"],cache:{},enabled:!0,element:null,nodes:null,node:null,options:{context:null,delegate:"",className:"",animation:"",mode:"click",errorMessage:null,loadingMessage:null,template:"",templateFrom:"",onInit:null,onHide:null,onShow:null,onLoad:null},initialize:function(a){this.setOptions(a||{})},bindEvents:function(){var a,b=this.options,c="click"===b.mode?"click":"mouseenter";return b.delegate?(c+=":relay("+b.delegate+")",a=document.id(b.context||document.body)):this.element&&(a=this.element),a&&a.addEvent(c,this.__show),this},className:function(){return Object.keyOf(window.Toolkit,this.$constructor)},createElement:function(){var a,b=this.options;if(this.element)return this;if(b.templateFrom&&(a="element"===typeOf(b.templateFrom)?b.templateFrom:document.getElement(b.templateFrom)),!a&&b.template&&(a=this.parseTemplate(b.template),a&&a.conceal().inject(document.body)),!a)throw new Error(this.className()+" failed to create template element");return this.setElement(a),this},disable:function(){return this.enabled=!1,this},enable:function(){return this.enabled=!0,this},hide:function(a){return this.isVisible()&&(this.element.conceal(),"function"===typeOf(a)&&a(),this.fireEvent("hide")),this},isVisible:function(){return this.element&&this.element.isShown()},parseTemplate:function(a){if(!a)return null;if("element"===typeOf(a))return a;var b=Elements.from(a);if(b[0])return b[0];throw new Error(this.className()+" template failed to parse")},position:function(a){return this.element.set("html",a),this.fireEvent("load",a),this},readValue:function(a,b){return b?"function"===typeOf(b)?b.call(this,a):a.get(b):null},requestData:function(a,b,c,d){if(this.cache[a])return this;var e={url:a,method:"get",evalScripts:!0,onRequest:b||function(){this.cache[a]=!0,this.options.showLoading&&(this.element.addClass(Toolkit.options.isPrefix+"loading"),this.position(this._loadingTemplate()))}.bind(this),onSuccess:c||function(b){this.cache[a]=b,this.options.showLoading&&this.element.removeClass(Toolkit.options.isPrefix+"loading"),this.position(b)}.bind(this),onFailure:d||function(){delete this.cache[a],this.element.removeClass(Toolkit.options.isPrefix+"loading").addClass(Toolkit.options.hasPrefix+"failed"),this.position(this._errorTemplate())}.bind(this)};return"object"===typeOf(this.options.ajax)&&(e=Object.merge(this.options.ajax,e)),new Request(e).get(),this},setElement:function(a){return"string"===typeOf(a)&&(a=document.getElement(a)),this.element=a,this.options.template=!1,this.options.className&&this.element.addClass(this.options.className),this.options.animation&&this.element.addClass(this.options.animation),this},setNodes:function(a){return this.nodes=a,this},setOptions:function(){var a=Object.merge.apply(null,[{},this.options].append(arguments));if(Toolkit.isTouch&&"hover"===a.mode&&(a.mode="click"),this.addEvent)for(var b in a)"function"===typeOf(a[b])&&/^on[A-Z]/.test(b)&&(this.addEvent(b,a[b]),delete a[b]);return this.options=a,this},show:function(a){return this.node=a,this.element.reveal(),this.fireEvent("show"),this},toElement:function(){return this.element},_errorTemplate:function(){return new Element("div."+this.className().toLowerCase()+"-error",{text:this.options.errorMessage||Toolkit.messages.error})}.protect(),_loadingTemplate:function(){return new Element("div."+this.className().toLowerCase()+"-loading",{text:this.options.loadingMessage||Toolkit.messages.loading})}.protect(),__hide:function(a){"domevent"===typeOf(a)&&a.stop(),this.hide()},__show:function(a,b){"domevent"===typeOf(a)&&a.stop(),this.enabled&&(b=b||a.target,this.isVisible()&&("click"===this.options.mode&&this.hide(),b===this.node)||this.show(b))}})}();