/*!
 * Titon Toolkit v1.1.0-alpha
 * Copyright 2010-2013, The Titon Project - http://titon.io
 * BSD-2 - https://github.com/titon/toolkit/blob/master/license.md
 */
!function(){"use strict";Toolkit.Input=new Class({Extends:Toolkit.Component,wrapper:null,options:{checkbox:'input[type="checkbox"]',radio:'input[type="radio"]',select:"select"},initialize:function(a,b){this.parent(b),this.setElement(a),this.element&&(this.bindEvents(),this.fireEvent("init"))},bindEvents:function(){var a=this.options;return a.checkbox&&this.element.getElements(a.checkbox).each(function(b){b.$checkbox=new Toolkit.Input.Checkbox(b,a)}),a.radio&&this.element.getElements(a.radio).each(function(b){b.$radio=new Toolkit.Input.Radio(b,a)}),a.select&&this.element.getElements(a.select).each(function(b){(!b.multiple||a.multiple)&&(b.$select=new Toolkit.Input.Select(b,a))}),this},_buildWrapper:function(a){var b=new Element("div."+Toolkit.options.vendor+"custom-input"),c=(a.get("class")||"").replace(/\binput\b/,"").trim();return c&&b.addClass(c),b.wraps(a),this.wrapper=b,b}}),Toolkit.Input.Checkbox=new Class({Extends:Toolkit.Input,checkbox:null,initialize:function(a,b){this.setOptions(b),this.checkbox=a,this._buildWrapper(a),this.setElement(new Element("label."+Toolkit.options.vendor+"checkbox").setProperty("for",a.get("id")).inject(a,"after"))}}),Toolkit.Input.Radio=new Class({Extends:Toolkit.Input,radio:null,initialize:function(a,b){this.setOptions(b),this.radio=a,this._buildWrapper(a),this.setElement(new Element("label."+Toolkit.options.vendor+"radio").setProperty("for",a.get("id")).inject(a,"after"))}}),Toolkit.Input.Select=new Class({Extends:Toolkit.Input,Binds:["_buildOption","__change"],select:null,button:null,dropdown:null,options:{multiple:!1,dropdown:!0},initialize:function(a,b){this.setOptions(b),this.select=a,this._buildWrapper(a),this._buildButton(a),this.options.dropdown&&(this._buildDropdown(a),this.button.addEvent("click",this.__show),a.addEvent("focus",this.__show).addEvent("blur",this.__show).setStyle("z-index",1)),a.addEvent("change",this.__change)},_buildButton:function(a){var b=Toolkit.options.vendor;return this.button=new Element("div."+b+"select").grab(new Element("div."+b+"select-arrow").set("html",'<span class="caret-down"></span>')).grab(new Element("div."+b+"select-label").set("text",a[a.selectedIndex].textContent)).setStyle("min-width",a.getWidth()).inject(a,"after")},_buildDropdown:function(a){var b=Toolkit.options.vendor,c=this._buildOption,d=new Element("ul."+b+"dropdown");return this.dropdown=d,this.wrapper.grab(d),Array.from(a.children).each(function(a){"optgroup"===a.get("tag")?(d.grab(new Element("li").addClass(b+"dropdown-heading").set("text",a.get("label"))),Array.from(a.children).each(function(a){d.grab(c(a))})):d.grab(c(a))}),d},_buildOption:function(a){var b=this.select,c=this.dropdown,d=Toolkit.options.isPrefix+"active",e=new Element("li");a.selected&&e.addClass(d);var f=new Element("a").set("text",a.textContent).set("href","javascript:;").addEvent("click",function(){b.set("value",a.value),b.fireEvent("change",{target:b}),c.conceal(),c.getElements("li").removeClass(d),this.getParent().addClass(d)});return e.grab(f)},__change:function(a){var b=a.target;b[b.selectedIndex]&&b.getParent().getElement("."+Toolkit.options.vendor+"select-label").set("text",b[b.selectedIndex].textContent)},__show:function(){if(!this.select.disabled){var a=this.dropdown;a.isShown()?a.conceal():a.reveal(),this.button.toggleClass("is-active")}}}),Element.implement("input",function(a){return this.$input||(this.$input=new Toolkit.Input(this,a)),this})}();