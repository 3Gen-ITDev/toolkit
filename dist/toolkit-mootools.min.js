/*!
 * Titon Toolkit v1.2.0
 * Copyright 2010-2014, The Titon Project - http://titon.io
 * BSD-2 - https://github.com/titon/toolkit/blob/master/license.md
 */
!function(a){"use strict";a.Toolkit={version:"1.2.0",build:"hsqq1fxa",options:{vendor:"",isPrefix:"is-",hasPrefix:"has-"},messages:{loading:"Loading...",error:"An error has occurred!"},hasTransition:function(){for(var a="transition WebkitTransition MozTransition OTransition msTransition".split(" "),b=document.createElement("div").style,c=0;c<a.length;c++)if(a[c]in b)return a[c];return!1}(),isTouch:!!("ontouchstart"in a||a.DocumentTouch&&document instanceof DocumentTouch),isRetina:a.devicePixelRatio>1,autobox:function(a){return a="null"===typeOf(a)?null:"true"===a?!0:"false"===a?!1:isNaN(a)?String.from(a):Number.from(a)},createComponent:function(a,b,c){var d=a,e="$"+d;c?(Elements.prototype[d]&&(d="toolkit"+d.charAt(0).toUpperCase()+d.slice(1)),Elements.implement(d,function(){var a=b.apply(this,arguments);return this.each(function(b){b[e]||(b[e]=a)})})):(Element.prototype[d]&&(d="toolkit"+d.charAt(0).toUpperCase()+d.slice(1)),Element.implement(d,function(){return this[e]||(this[e]=b.apply(this,arguments)),this}))}},Element.implement({toolkit:function(a){return this["$"+a]||null},reveal:function(){return this.swapClass("hide","show")},conceal:function(){return this.swapClass("show","hide")},isShown:function(){return"hidden"!==this.getStyle("visibility")},positionTo:function(b,c,d,e){var f=d||{left:0,top:0},g=0,h=0,i=this.getDimensions({computeSize:!0,styles:["padding","border","margin"]});if("domevent"===typeOf(c))f.left+=c.page.x,f.top+=c.page.y;else{var j=c.getPosition(),k=b,l=a.getSize(),m=a.getScroll().top;f.left+=j.x,f.top+=j.y,g=c.getHeight(),h=c.getWidth(),j.top-i.totalHeight-m<0?k=k.replace("top","bottom"):j.top+g+i.totalHeight>l.y&&(k=k.replace("bottom","top")),j.left-i.totalWidth<0?k=k.replace("left","right"):j.left+h+i.totalWidth>l.x&&(k=k.replace("right","left")),b!==k&&(this.removeClass(b).addClass(k).set("data-new-position",k),b=k)}var n=b.split("-"),o={y:n[0],x:n[1]};return"top"===o.y?f.top-=i.totalHeight:"bottom"===o.y?f.top+=g:"center"===o.y&&(f.top-=Math.round(i.totalHeight/2-g/2)),"left"===o.x?f.left-=i.totalWidth:"right"===o.x?f.left+=h:"center"===o.x&&(f.left-=Math.round(i.totalWidth/2-h/2)),e&&("center"===o.y&&("left"===o.x?f.left-=15:"right"===o.x&&(f.left+=15)),"center"===o.x&&("top"===o.y?f.top-=10:"bottom"===o.y&&(f.top+=20))),this.setStyles(f)}}),Elements.implement({toolkit:function(a){var b="$"+a,c=[];return this.each(function(a){a[b]&&c.push(a[b])}),1===c.length&&c[0]?c[0]:c}}),Array.implement({chunk:function(a){var b=this;return[].concat.apply([],b.map(function(c,d){return d%a?[]:[b.slice(d,d+a)]}))}}),Number.implement({bound:function(a,b){var c=this;return b=b||0,c>=a?c=0:b>c&&(c=a-1),c}}),Function.implement({debounce:function(a,b){var c,d=this;return function(){var e=this,f=arguments;clearTimeout(c),c=setTimeout(function(){c=null,b||d.apply(e,f)},a||150),b&&!c&&d.apply(e,f)}}}),Element.Events.clickout=function(){function a(a){var b=!0;return c.each(function(c){b&&(b=c!==a.target&&0===c.getElements(a.target).length)}),b}function b(b){a(b)&&c.fireEvent("clickout",[b.target])}var c=new Elements;return{base:"click",condition:a,onAdd:function(){c.push(this),1===c.length&&document.addEvent("click",b)},onRemove:function(){c.pop(this),0===c.length&&document.removeEvent("click",b)}}}(),Element.Properties.html.set=function(a){var b=typeOf(a);return"element"===b?(this.innerHTML="",this.appendChild(a),this):("string"===b&&a.match(/^#[a-z0-9_\-\.:]+$/i)?a=document.getElement(a).get("html"):"array"===b&&(a=a.join("")),this.innerHTML=a,this)}}(window);!function(){"use strict";Toolkit.Component=new Class({Implements:[Events,Options],Binds:["onShow","onHide","position"],cache:{},events:{},enabled:!1,element:null,nodes:null,node:null,options:{context:null,delegate:"",className:"",template:"",templateFrom:""},initialize:function(a){this.setOptions(a||{})},bindEvents:function(a){var b,c,d,e,f,g=this,h=window,i=document,j="on"===a?"addEvent":"removeEvent";return Object.each(this.events,function(a,k){f="array"===typeOf(a)?a:[a],c=k.split(" "),b=c[0],d=c[1],e=c[2]||null,"."!==d.charAt(0)&&"#"!==d.charAt(0)||"clickout"===b||(e=d,d=g.options.context),"undefined"!=typeof g[d]&&(d=g[d]),("array"!==typeOf(d)||d.length)&&f.each(function(a){"function"!==typeOf(a)&&(a=g[a].bind(g)),"window"===d?h[j](b,a):"document"===d?"ready"===b?h[j]("domready",a):i[j](b,a):"clickout"===b?$$(d)[j](b,a):e?(d||i)[j](b+":relay("+e+")",a):d[j](b,a)})}),this},className:function(){return Object.keyOf(window.Toolkit,this.$constructor)},createElement:function(){var a,b=this.options;if(this.element)return this;if(b.templateFrom&&(a="element"===typeOf(b.templateFrom)?b.templateFrom:document.getElement(b.templateFrom)),!a&&b.template&&(a=this.parseTemplate(b.template),a&&a.conceal().inject(document.body)),!a)throw new Error(this.className()+" failed to create template element");return b.className&&a.addClass(b.className),b.animation&&a.addClass(b.animation),this.element=a,this},disable:function(){return this.enabled=!1,this.bindEvents("off"),this},enable:function(){return this.enabled=!0,this.bindEvents("on"),this},hide:function(a){return this.isVisible()&&(this.element.conceal(),"function"===typeOf(a)&&a(),this.fireEvent("hide")),this},inheritOptions:function(a,b){var c,d,e={};for(c in a)"context"!==c&&"template"!==c&&(d=b.get("data"+this.className().hyphenate()+"-"+c.toLowerCase()),"null"!==typeOf(d)&&(e[c]=Toolkit.autobox(d)));return Object.merge({},a,e)},isVisible:function(){return this.element&&this.element.isShown()},parseTemplate:function(a){if(!a)return null;if("element"===typeOf(a))return a;var b=Elements.from(a);if(b[0])return b[0];throw new Error(this.className()+" template failed to parse")},position:function(a){return this.element.set("html",a),this.fireEvent("load",a),this},process:function(a){if(this.hide(),a.callback){for(var b=a.callback.split("."),c=window,d=c,e=0;e<b.length;e++)d=c,c=c[b[e]];c.call(d,a)}return this.fireEvent("process",a),this},readOption:function(a,b){var c=a.get("data"+this.className().hyphenate()+"-"+b.toLowerCase());return c="null"===typeOf(c)?this.options[b]:Toolkit.autobox(c)},readValue:function(a,b){return b?"function"===typeOf(b)?b.call(this,a):a.get(b):null},requestData:function(a,b,c,d){var e=a.url||a,f=Object.merge({url:e,method:"GET",evalScripts:!0,onRequest:b||function(){this.cache[e]=!0,this.element.addClass(Toolkit.options.isPrefix+"loading")}.bind(this)},a);"object"===typeOf(this.options.ajax)&&(f=Object.merge({},this.options.ajax,f));var g=this,h="GET"===f.method.toUpperCase();return f.onSuccess=c||function(a){var b=this.xhr.getResponseHeader("Content-Type");g.element.removeClass(Toolkit.options.isPrefix+"loading"),b.indexOf("text/html")>=0?(h?g.cache[e]=a:delete g.cache[e],g.position(a)):(delete g.cache[e],"application/json"===b&&(a=JSON.parse(a)),g.process(a))},f.onFailure=d||function(){delete this.cache[e],this.element.removeClass(Toolkit.options.isPrefix+"loading").addClass(Toolkit.options.hasPrefix+"failed"),this.position(this._errorTemplate())}.bind(this),new Request(f).send(),this},setOptions:function(a,b){if(a=Object.merge({},this.options,a||{}),b&&(a=this.inheritOptions(a,b)),a.mode&&"hover"===a.mode&&(a.mode=Toolkit.isTouch?"click":"mouseenter"),this.addEvent)for(var c in a)"function"===typeOf(a[c])&&/^on[A-Z]/.test(c)&&(this.addEvent(c,a[c]),delete a[c]);return this.options=a,this},show:function(a){return this.node=a,this.element.reveal(),this.fireEvent("show"),this},toElement:function(){return this.element},_errorTemplate:function(){return new Element("div."+this.className().hyphenate().slice(1)+"-error",{text:Toolkit.messages.error})}.protect(),_loadingTemplate:function(){return new Element("div."+this.className().hyphenate().slice(1)+"-loading",{text:Toolkit.messages.loading})}.protect(),onHide:function(a){"domevent"===typeOf(a)&&a.preventDefault(),this.hide()},onShow:function(a,b){if(this.enabled){if(b=b||a.target,this.isVisible()){if(Toolkit.isTouch?(b!==this.node||"a"!==this.node.get("tag"))&&a.preventDefault():a.preventDefault(),"click"===this.options.mode&&this.hide(),b===this.node)return}else"domevent"===typeOf(a)&&a.preventDefault();this.show(b)}}})}();!function(){"use strict";Toolkit.Accordion=new Class({Extends:Toolkit.Component,headers:[],sections:[],index:0,options:{mode:"click",defaultIndex:0,multiple:!1,collapsible:!1,headerElement:".accordion-header",sectionElement:".accordion-section"},initialize:function(a,b){this.parent(b),this.element=a,this.options=b=this.inheritOptions(this.options,a);var c=a.getElements(b.sectionElement),d=a.getElements(b.headerElement);this.headers=d,this.sections=c,d.each(function(a,b){a.set("data-index",b)}),c.each(function(a){a.set("data-height",a.getHeight()).conceal()}),this.events[b.mode+" headers"]="onShow",this.enable(),this.fireEvent("init"),this.jump(b.defaultIndex)},jump:function(a){return a=a.bound(this.headers.length),this.fireEvent("jump",a),this.show(this.headers[a])},show:function(a){var b=this.options,c=a.getParent(),d=a.getNext(),e=a.get("data-index"),f=d.get("data-height").toInt(),g=Toolkit.options.isPrefix;if("click"===b.mode&&(b.multiple||b.collapsible&&this.node===a))d.isShown()&&this.node?(d.setStyle("max-height",0).conceal(),c.removeClass(g+"active")):(d.setStyle("max-height",f).reveal(),c.addClass(g+"active"));else{if(this.node===a)return this;this.sections.setStyle("max-height",0).conceal(),d.setStyle("max-height",f).reveal(),this.element.getChildren("li").removeClass(g+"active"),c.addClass(g+"active")}return this.index=e,this.node=a,this.fireEvent("show",[d,a,e]),this},onShow:function(a){a.preventDefault();for(var b=a.target,c=this.headers;!c.contains(b);)b=b.getParent();b&&this.show(b)}}),Toolkit.createComponent("accordion",function(a){return new Toolkit.Accordion(this,a)})}();!function(){"use strict";Toolkit.Blackout=new Class({Extends:Toolkit.Component,count:0,loader:null,message:null,options:{loader:"bar-wave",waveCount:5,template:'<div class="'+Toolkit.options.vendor+'blackout" id="toolkit-blackout"></div>',templateFrom:"#toolkit-blackout"},initialize:function(a){this.parent(a),this.createElement(),this.createLoader(),this.fireEvent("init")},createLoader:function(){var a=this.options,b=Toolkit.options.vendor,c="bubble-spinner"===a.loader?8:a.waveCount;this.loader=new Element("div."+b+"loader."+a.loader).inject(this.element);var d,e="";for(d=0;c>d;d++)e+="<span></span>";"bubble-spinner"===a.loader?new Element("div.spinner").set("html",e).inject(this.loader):this.loader.set("html",e),this.message=new Element("div."+b+"loader-message").set("html",Toolkit.messages.loading).inject(this.loader)},hide:function(){var a=this.count-1;return 0>=a?(this.count=0,this.element.conceal(),this.hideLoader()):this.count=a,this.fireEvent("hide",0>=a),this},hideLoader:function(){return this.loader.conceal(),this.fireEvent("hideLoader"),this},show:function(){var a=!1;return this.count++,1===this.count&&(this.element.reveal(),a=!0),this.showLoader(),this.fireEvent("show",a),this},showLoader:function(){return this.loader.reveal(),this.fireEvent("showLoader"),this}});var a=null;Toolkit.Blackout.factory=function(b){return a?a:a=new Toolkit.Blackout(b)}}();!function(a){"use strict";a.Cache=new Class({storage:null,setStorage:function(b){if(!a.JSON)throw new Error("JSON is required for caching and storage");switch(b.toLowerCase()){case"local":case"localstorage":if(a.localStorage)try{return a.localStorage.setItem("_temp_","Titon"),a.localStorage.removeItem("_temp_"),void(this.storage=a.localStorage)}catch(c){}case"session":case"sessionstorage":if(a.sessionStorage)try{return a.sessionStorage.setItem("_temp_","Titon"),a.sessionStorage.removeItem("_temp_"),void(this.storage=a.sessionStorage)}catch(d){}default:this.storage=function(){var a={},b=0;return{length:b,clear:function(){a={},b=0},getItem:function(b){return a[b]||null},setItem:function(c,d){a[c]=d,b++},removeItem:function(c){delete a[c],b--}}}()}},cacheSize:function(){return this.storage.length||0},flushCache:function(){this.storage&&this.storage.clear()},getCache:function(a){if(this.storage&&a){var b=this.storage.getItem(a);if(b)return JSON.parse(b)}return null},hasCache:function(a){return this.storage&&this.storage.getItem(a)},setCache:function(a,b){if(this.storage&&a)try{return this.storage.setItem(a,JSON.stringify(b||"")),!0}catch(c){}return!1},removeCache:function(a){this.storage&&a&&this.storage.removeItem(a)}})}(window);!function(){"use strict";Toolkit.Carousel=new Class({Extends:Toolkit.Component,Binds:["next","prev","start","stop","resize","onCycle","onJump"],stopped:!1,itemsWrapper:null,itemsList:null,items:[],tabsWrapper:null,tabs:[],prevButton:null,nextButton:null,index:0,timer:null,options:{animation:"slide",duration:5e3,autoCycle:!0,stopOnHover:!0,itemsElement:".carousel-items",itemElement:"li",tabsElement:".carousel-tabs",tabElement:"a",nextElement:".carousel-next",prevElement:".carousel-prev",template:!1},initialize:function(a,b){if(this.parent(b),this.element=a,this.options=b=this.inheritOptions(this.options,a),this.itemsWrapper=a.getElement(b.itemsElement),this.itemsWrapper&&(this.itemsList=this.itemsWrapper.getChildren("ul, ol"),this.items=this.itemsWrapper.getElements(b.itemElement)),this.tabsWrapper=a.getElement(b.tabsElement),this.tabsWrapper&&(this.tabs=this.tabsWrapper.getElements(b.tabElement)),this.nextButton=a.getElement(b.nextElement),this.prevButton=a.getElement(b.prevElement),this.items.length<=1)return this.tabsWrapper.hide(),this.nextButton.hide(),void this.prevButton.hide();switch(a.addClass(b.animation),b.animation){case"fade":this.items[0].reveal();break;case"slide":this.itemsList.setStyle("width",100*this.items.length+"%"),this.items.setStyle("width",100/this.items.length+"%")}this.tabs.forEach(function(a,b){a.set("data-index",b)}),this.events={"keydown window":"onKeydown","swipe element":"onSwipe","click tabs":"onJump","click nextButton":"next","click prevButton":"prev"},b.stopOnHover&&(this.events["mouseenter element"]="stop",this.events["mouseleave element"]="start"),this.enable(),this.fireEvent("init"),this.reset().start()},jump:function(a){switch(this.index=a=a.bound(this.items.length),this.tabs.length&&(this.tabs.removeClass(Toolkit.options.isPrefix+"active"),this.tabs[a]&&this.tabs[a].addClass(Toolkit.options.isPrefix+"active")),this.options.animation){case"fade":this.items.removeClass("show"),this.items[a].reveal();break;case"slide-up":this.itemsList.setStyle("top",-(100*a)+"%");break;default:this.itemsList.setStyle("left",-(100*a)+"%")}return this.reset(),this.fireEvent("jump",a),this},next:function(){return this.jump(this.index+1),this},prev:function(){return this.jump(this.index-1),this},reset:function(){return this.options.autoCycle&&(clearInterval(this.timer),this.timer=setInterval(this.onCycle,this.options.duration)),this},start:function(){return this.element.removeClass(Toolkit.options.isPrefix+"stopped"),this.stopped=!1,this.fireEvent("start"),this},stop:function(){return this.element.addClass(Toolkit.options.isPrefix+"stopped"),this.stopped=!0,this.fireEvent("stop"),this},onCycle:function(){this.stopped||(this.fireEvent("cycle",this.index),this.next())},onJump:function(a){a.preventDefault(),this.jump(a.target.get("data-index")||0)},onKeydown:function(a){if(["up","down","left","right"].contains(a.key))switch(a.preventDefault(),a.key){case"up":this.jump(0);break;case"down":this.jump(-1);break;case"left":this.prev();break;case"right":this.next()}},onSwipe:function(a){"left"===a.direction?this.next():"right"===a.direction&&this.prev()}}),Toolkit.createComponent("carousel",function(a){return new Toolkit.Carousel(this,a)})}();!function(){"use strict";Toolkit.Drop=new Class({Extends:Toolkit.Component,options:{delegate:".js-drop",getTarget:"data-drop",hideOpened:!0},initialize:function(a,b){this.parent(b),this.nodes=a;var c={},d=this.options.delegate,e=d;["down","up","left","right"].each(function(a){e+=",."+Toolkit.options.vendor+"drop--"+a}),c["clickout "+e]="hide",c[this.options.mode+" "+d]="onShow",this.events=c,this.enable(),this.fireEvent("init")},hide:function(){return this.parent(function(){this.node.removeClass(Toolkit.options.isPrefix+"active")}.bind(this))},show:function(a){return this.parent(a),this.node.addClass(Toolkit.options.isPrefix+"active"),this},onShow:function(a,b){"domevent"===typeOf(a)&&a.preventDefault();var c=this.readValue(b,this.options.getTarget);c&&"#"===c.substr(0,1)&&(this.options.hideOpened&&this.node&&this.node!==b&&this.hide(),this.element=document.id(c.slice(1)),this.node=b,this.isVisible()?this.hide():this.show(b))}}),Toolkit.createComponent("drop",function(a){return new Toolkit.Drop(this,a)},!0)}();!function(a){"use strict";a.Timers=new Class({timers:{},$timers:{},addTimer:function(a,b){return this.timers[a]=Function.from(b),this},addTimers:function(a){for(var b in a)this.addTimer(b,a[b]);return this},startTimer:function(a,b,c){return this.clearTimer(a),this.timers[a]&&(this.$timers[a]=this.timers[a].delay(b,this,c)),this},startInterval:function(a,b,c){return this.clearTimer(a),this.timers[a]&&(this.$timers[a]=this.timers[a].periodical(b,this,c)),this},clearTimer:function(b,c,d){return a.clearTimeout(this.$timers[b]),delete this.$timers[b],"function"===typeOf(c)&&c.apply(this,d||[]),this},clearTimers:function(a){return a?Array.from(a).each(function(a){this.clearTimer(a)},this):Object.each(this.$timers,function(a,b){this.clearTimer(b)},this),this},removeTimer:function(a){return delete this.timers[a],this},removeTimers:function(a){return Array.from(a).each(function(a){this.removeTimer(a)},this),this}})}(window);!function(){"use strict";Toolkit.Flyout=new Class({Extends:Toolkit.Component,Implements:[Timers],current:null,menus:{},data:[],dataMap:{},options:{delegate:".js-flyout",mode:"hover",getUrl:"href",xOffset:0,yOffset:0,showDelay:350,hideDelay:1e3,itemLimit:15,contentElement:".flyout",template:'<div class="flyout"></div>'},initialize:function(a,b,c){if(this.parent(c),this.nodes=a,!b)throw new Error("Flyout URL required to download sitemap JSON");c=this.options,new Request.JSON({url:b,secure:!0,onSuccess:this.load.bind(this)}).get(),this.addTimers({show:this.position,hide:this.onHide}),"click"===c.mode?this.events["click "+c.delegate]="onShow":(this.events["mouseenter "+c.delegate]=["onShow","onEnter"],this.events["mouseleave "+c.delegate]="onLeave"),this.enable(),this.fireEvent("init")},hide:function(){return this.clearTimers(),this.node.removeClass(Toolkit.options.isPrefix+"active"),this.current&&this.isVisible()?(this.menus[this.current].conceal(),this.fireEvent("hide"),this.current=null,this):this},isVisible:function(){return this.current&&this.menus[this.current]&&(this.element=this.menus[this.current]),this.parent()},load:function(a,b){if(b=b||0,0===b&&(this.data=a),a.url&&(this.dataMap[a.url]=a),a.children)for(var c=0,d=a.children.length;d>c;c++)this.load(a.children[c],b+1);return this},position:function(){var a=this.current,b=this.options;if(!this.menus[a])return this;var c=this.menus[a],d=c.getDimensions().height,e=this.node.getCoordinates(),f=e.left+b.xOffset,g=e.top+b.yOffset+e.height,h=window.getScrollSize();return g>h.y/2&&(g=e.top-b.yOffset-d),c.setPosition({x:f,y:g}).reveal(),this.fireEvent("show"),this},show:function(a){var b=this._getTarget(a);return this.current&&b!==this.current&&(this.hide(),this.startTimer("show",this.options.showDelay)),this.node=a,this._getMenu()?(this.node.addClass(Toolkit.options.isPrefix+"active"),"click"===this.options.mode&&this.position(),this):this},_buildMenu:function(a,b){if(!b.children||!b.children.length)return null;var c,d,e,f=this.parseTemplate(this.options.template),g=[],h=this.options.contentElement,i=this.options.itemLimit;this.options.className&&f.addClass(this.options.className),a===document.body&&f.addClass(Toolkit.options.isPrefix+"root"),i&&b.children.length>i?g=b.children.chunk(i):g.push(b.children);for(var j,k=0;j=g[k];k++){c=new Element("ul");for(var l,m=0,n=j.length;n>m;m++)l=j[m],d=new Element("li"),l.url?(e=new Element("a",{text:l.title,href:l.url}),new Element("span").addClass(l.icon||"caret-right").inject(e,"top")):(e=new Element("span",{text:l.title}),d.addClass(Toolkit.options.vendor+"flyout-heading")),l.attributes&&e.set(l.attributes),l.className&&d.addClass(l.className),d.grab(e).inject(c),l.children&&l.children.length&&(this._buildMenu(d,l),d.addClass(Toolkit.options.hasPrefix+"children").addEvent("mouseenter",this.onPositionChild.bind(this,d)).addEvent("mouseleave",this.onHideChild.bind(this,d)));h?"."===h.substr(0,1)&&f.hasClass(h.substr(1))?f.grab(c):f.getElement(h).grab(c):f.grab(c)}return f.inject(a),f}.protect(),_getMenu:function(){var a=this._getTarget();if(this.menus[a])return this.current=a,this.menus[a];if(this.dataMap[a]){var b=this._buildMenu(document.body,this.dataMap[a]);return b?(b.conceal(),"click"!==this.options.mode&&b.addEvents({mouseenter:function(){this.clearTimer("hide")}.bind(this),mouseleave:function(){this.startTimer("hide",this.options.hideDelay)}.bind(this)}),this.current=a,this.menus[a]=b,this.menus[a]):null}return null}.protect(),_getTarget:function(a){return a=a||this.node,this.readValue(a,this.options.getUrl)||a.get("href")}.protect(),onEnter:function(){this.clearTimer("hide").startTimer("show",this.options.showDelay)},onHideChild:function(a){a.removeClass(Toolkit.options.isPrefix+"open"),a.getChildren(this.options.contentElement).removeProperty("style"),this.fireEvent("hideChild",a)},onLeave:function(){this.clearTimer("show").startTimer("hide",this.options.showDelay)},onPositionChild:function(a){var b=a.getElement(this.options.contentElement);if(b){var c=b.getChildren("ul");b.setStyle("width",c.getWidth()[0]*c.length+"px");var d=window.getScrollSize(),e=window.getCoordinates(),f=a.getCoordinates(),g=b.getCoordinates(),h=f.right+g.width;h>=e.width?b.addClass("push-left"):b.removeClass("push-left"),f.top>d.y/2?b.setStyle("top","-"+(g.height-f.height)+"px"):b.setStyle("top",0),a.addClass(Toolkit.options.isPrefix+"open"),this.fireEvent("showChild",a)}}}),Toolkit.createComponent("flyout",function(a,b){return new Toolkit.Flyout(this,a,b)},!0)}();!function(){"use strict";Toolkit.Input=new Class({Extends:Toolkit.Component,wrapper:null,input:null,options:{checkbox:'input[type="checkbox"]',radio:'input[type="radio"]',select:"select",copyClasses:!0},initialize:function(a,b){this.parent(b),this.element=a,this.options=b=this.inheritOptions(this.options,a),b.checkbox&&a.getElements(b.checkbox).inputCheckbox(b),b.radio&&a.getElements(b.radio).inputRadio(b),b.select&&a.getElements(b.select).inputSelect(b),this.enable(),this.fireEvent("init")},buildWrapper:function(a){return this.wrapper=new Element("div."+Toolkit.options.vendor+"custom-input").wraps(a),this.options.copyClasses&&this.copyClasses(a,this.wrapper),this},copyClasses:function(a,b){var c=(a.get("class")||"").replace(/\binput\b/,"").trim();return c&&b.addClass(c),this}}),Toolkit.InputCheckbox=new Class({Extends:Toolkit.Input,initialize:function(a,b){this.input=a,this.setOptions(b,a),this.buildWrapper(a),this.element=new Element("label."+Toolkit.options.vendor+"checkbox").setProperty("for",a.get("id")).inject(a,"after"),this.enable(),this.fireEvent("init")}}),Toolkit.InputRadio=new Class({Extends:Toolkit.Input,initialize:function(a,b){this.input=a,this.setOptions(b,a),this.buildWrapper(a),this.element=new Element("label."+Toolkit.options.vendor+"radio").setProperty("for",a.get("id")).inject(a,"after"),this.enable(),this.fireEvent("init")}}),Toolkit.InputSelect=new Class({Extends:Toolkit.Input,Binds:["buildOption","onChange","onCycle","onToggle"],dropdown:null,multiple:!1,index:0,options:{"native":!1,multipleFormat:"count",countMessage:"{count} of {total} selected",listLimit:3,hideFirst:!1,hideSelected:!1,arrowContent:'<span class="caret-down"></span>',getDefaultLabel:"title",getOptionLabel:"title",getDescription:"data-description"},initialize:function(a,b){if(this.input=a,this.setOptions(b,a),this.multiple=a.multiple,!a.multiple||!this.options.native){var c={"change input":"onChange"};this.buildWrapper(a),this.buildButton(a),this.options.native||(c["blur input"]="hide",c["clickout dropdown"]="hide",c["clickout element"]="hide",c["click element"]="onToggle",this.multiple||(c["keydown window"]="onCycle"),this.buildDropdown(a),a.setStyle("z-index",1)),this.events=c,this.enable(),this.fireEvent("init"),this.input.fireEvent("change",{target:a})}},buildButton:function(a){var b=Toolkit.options.vendor;return this.element=new Element("div."+b+"select").grab(new Element("div."+b+"select-arrow").set("html",this.options.arrowContent)).grab(new Element("div."+b+"select-label").set("text",Toolkit.messages.loading)).setStyle("min-width",a.getWidth()).inject(a,"after"),this.multiple&&this.input.setStyle("max-height",this.element.getHeight()),this},buildDropdown:function(a){var b=Toolkit.options.vendor,c=this.options,d=this.buildOption,e=new Element("div."+b+"drop--down."+b+"select-options"),f=new Element("ul"),g=0;return this.dropdown=e,Array.from(a.children).each(function(a){"optgroup"===a.get("tag")?(0===g&&(c.hideFirst=!1),f.grab(new Element("li").addClass(b+"drop-heading").set("text",a.get("label"))),Array.from(a.children).each(function(b){a.disabled&&(b.disabled=!0),b.selected&&(this.index=g),f.grab(d(b,g)),g++},this)):(a.selected&&(this.index=g),f.grab(d(a,g)),g++)},this),c.hideSelected&&!c.multiple&&e.addClass("hide-selected"),c.hideFirst&&e.addClass("hide-first"),a.multiple&&e.addClass(Toolkit.options.isPrefix+"multiple"),this.wrapper.grab(e.grab(f)),this},buildOption:function(a,b){var c,d=this.input,e=this.dropdown,f=Toolkit.options.isPrefix+"active",g=new Element("li"),h=a.textContent;a.selected&&g.addClass(f),(c=this.readValue(a,this.options.getDescription))&&(h+=' <span class="'+Toolkit.options.vendor+'drop-desc">'+c+"</span>");var i=new Element("a").set("html",h).set("href","javascript:;");if(this.options.copyClasses&&this.copyClasses(a,g),g.grab(i),a.disabled)return g.addClass(Toolkit.options.isPrefix+"disabled"),g;if(this.multiple)i.addEvent("click",function(){a.selected?(a.selected=!1,this.getParent().removeClass(f)):(a.selected=!0,this.getParent().addClass(f)),d.fireEvent("change",{target:d})});else{var j=this;i.addEvent("click",function(){e.getElements("li").removeClass(f),this.getParent().addClass(f),j.hide(),j.index=b,d.set("value",a.value),d.fireEvent("change",{target:d})})}return g},hide:function(){return this.element.removeClass(Toolkit.options.isPrefix+"active"),this.dropdown&&this.dropdown.conceal(),this.fireEvent("hide"),this},show:function(){return this.element.addClass(Toolkit.options.isPrefix+"active"),this.dropdown&&this.dropdown.reveal(),this.fireEvent("show"),this},_loop:function(a,b,c){var d=this.options.hideFirst;for(a+=b;"undefined"==typeof c[a]||c[a].disabled||0===a&&d;)a+=b,a>=c.length?a=0:0>a&&(a=c.length-1);return a},onChange:function(a){var b=a.target,c=b.getElements("option"),d=[],e=[];if(c.each(function(a){a.selected&&(d.push(a),e.push(this.readValue(a,this.options.getOptionLabel)||a.textContent))},this),this.multiple){var f=this.readValue(b,this.options.getDefaultLabel),g=this.options.multipleFormat,h=e.length;if(!e.length&&f)e=f;else if("count"===g)e=this.options.countMessage.replace("{count}",h).replace("{total}",c.length);else if("list"===g){var i=this.options.listLimit;e=e.splice(0,i).join(", "),h>i&&(e+=" ...")}}else e=e.join(", ");b.getParent().getElement("."+Toolkit.options.vendor+"select-label").set("text",e),this.fireEvent("change",[b.get("value"),d])},onCycle:function(a){if(this.dropdown.isVisible()&&["up","down","enter","esc"].contains(a.key)){a.preventDefault();var b=this.input.getElements("option"),c=this.dropdown.getElements("a"),d=Toolkit.options.isPrefix+"active",e=this.index;switch(a.key){case"enter":case"esc":return void this.hide();case"up":e=this._loop(e,-1,b);break;case"down":e=this._loop(e,1,b)}b.set("selected",!1),b[e].selected=!0,c.getParent().removeClass(d),c[e].getParent().addClass(d),this.index=e,this.input.fireEvent("change",{target:this.input})}},onToggle:function(){this.input.disabled||(this.dropdown.isShown()?this.hide():this.show())}}),Toolkit.createComponent("input",function(a){return new Toolkit.Input(this,a)}),Toolkit.createComponent("inputRadio",function(a){return new Toolkit.InputRadio(this,a)}),Toolkit.createComponent("inputCheckbox",function(a){return new Toolkit.InputCheckbox(this,a)}),Toolkit.createComponent("inputSelect",function(a){return new Toolkit.InputSelect(this,a)})}();!function(){"use strict";Toolkit.LazyLoad=new Class({Extends:Toolkit.Component,Binds:["load","loadAll"],container:null,elements:[],isLoaded:!1,loaded:0,options:{lazyClass:".lazy-load",forceLoad:!1,delay:1e4,threshold:150,throttle:50,context:null},initialize:function(a,b){this.parent(b),this.options=this.inheritOptions(this.options,a),this.container="auto"===a.getStyle("overflow")?a:window,this.elements=a.getElements(".lazy-load");var c,d=this.options.throttle;this.events=c={"ready document":"onReady"},c["scroll:throttle("+d+") container"]="load",c["resize:throttle("+d+") window"]="load",this.enable(),this.fireEvent("init")},inViewport:function(a){var b=this.container,c=this.options.threshold,d=b.getSize(),e=b.getScroll(),f=a.getPosition(b===window?document.body:b);return a.isVisible()&&f.y>=e.y-c&&f.y<=e.y+d.y+c&&f.x>=e.x-c&&f.x<=e.x+d.x+c},load:function(){return this.isLoaded?!1:this.loaded===this.elements.length?(this.shutdown(),!1):(this.elements.each(function(a,b){a&&this.inViewport(a)&&this.show(a,b)},this),this.fireEvent("load"),!0)},loadAll:function(){return this.isLoaded?!1:(this.elements.each(function(a,b){a&&this.show(a,b)},this),this.fireEvent("loadAll"),this.shutdown(),!0)},show:function(a,b){return a.removeClass("lazy-load"),a.getElements("img").each(function(a){var b;Toolkit.isRetina&&(b=a.get("data-src-retina")),b||(b=a.get("data-src")),b&&a.set("src",b)}),this.elements.splice(b,1,null),this.loaded++,this.fireEvent("show",a),this},shutdown:function(){return this.isLoaded=!0,this.disable(),this.fireEvent("shutdown"),this},onReady:function(){this.load(),this.options.forceLoad&&setTimeout(this.loadAll.bind(this),this.options.delay)}}),Toolkit.createComponent("lazyLoad",function(a){return new Toolkit.LazyLoad(this,a)})}();!function(){"use strict";Toolkit.Mask=new Class({Extends:Toolkit.Component,mask:null,message:null,options:{revealOnClick:!1,messageContent:"",messageElement:".mask-message"},initialize:function(a,b){this.parent(b),this.element=a,this.options=this.inheritOptions(this.options,a);var c=Toolkit.options.vendor,d="."+c+"mask";a!==document.body&&(a.addClass(c+"maskable"),"static"===a.getStyle("position")&&a.setStyle("position","relative")),this.setMask(a.getElement("> "+d)||new Element("div"+d)),this.enable(),this.fireEvent("init")},hide:function(){return this.mask.conceal(),this.element.removeClass(Toolkit.options.isPrefix+"masked"),this.fireEvent("hide"),this},setMask:function(a){var b=this.options;return a.addClass("hide").inject(this.element,"bottom"),this.element===document.body&&a.setStyle("position","fixed"),b.revealOnClick&&a.addEvent("click",this.onHide),this.mask=a,this.message=a.getElement("> "+b.messageElement),this.message||(this.message=new Element("div"+b.messageElement).inject(a,"bottom"),b.messageContent&&this.message.set("html",b.messageContent)),this},show:function(a){return this.node=a,this.mask.reveal(),this.element.addClass(Toolkit.options.isPrefix+"masked"),this.fireEvent("show"),this},toggle:function(){return this.mask.isShown()?this.hide():this.show()}}),Toolkit.createComponent("mask",function(a){return new Toolkit.Mask(this,a)})}();!function(){"use strict";Toolkit.Matrix=new Class({Extends:Toolkit.Component,Binds:["onResize","onLoad"],items:[],matrix:[],wrapperWidth:0,colWidth:0,colCount:0,images:[],imagesLoaded:0,options:{width:200,gutter:20,rtl:!1,defer:!0,template:!1},initialize:function(a,b){this.parent(b),this.element=a,this.options=this.inheritOptions(this.options,a),a.addClass(Toolkit.options.vendor+"matrix"),this.items=a.getElements("> li"),this.events={"resize window":this.onResize.debounce()},this.enable(),this.fireEvent("init"),this.options.defer?this._deferRender():this.render()},append:function(a){return a.inject(this.element,"bottom").setStyle("opacity",0),this.refresh()},prepend:function(a){return a.inject(this.element,"top").setStyle("opacity",0),this.refresh()},refresh:function(){return this.items=this.element.getElements("> li"),this.render()},remove:function(a){return this.items.every(function(b){return b===a?(b.destroy(),!1):!0}),this.refresh()},render:function(){return this._calculateColumns(),this.items.length<this.colCount?this.element.removeProperty("style"):this.colCount<=1?(this.element.addClass("no-columns"),this.items.removeProperty("style")):(this.element.removeClass("no-columns"),this._organizeItems(),this._positionItems()),this.fireEvent("render"),this},_calculateColumns:function(){var a,b=this.element.getSize().x,c=this.options.width,d=this.options.gutter,e=Math.max(Math.floor(b/c),1),f=e*(c+d)-d;return e>1&&(f>b?(a=f-b,c-=a/e):b>f&&(a=b-f,c+=a/e)),this.wrapperWidth=b,this.colWidth=c,this.colCount=e,this}.protect(),_deferRender:function(){return this.imagesLoaded=0,this.images=this.element.getElements("img"),this.images.length?this.images.each(function(a){var b=a.src;a.onload=this.onLoad,a.onerror=this.onLoad,a.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",a.src=b},this):this.render(),this}.protect(),_organizeItems:function(){var a,b,c,d=0,e=this.items.length;this.matrix=[];for(var f=0;e>f;f++){if(a=this.items[f],c=a.getSize(),b=Math.max(Math.round(c.x/this.colWidth),1),this.matrix.push({item:a,span:b}),b>1)for(var g=1;b>g;g++)d++,this.matrix&&this.matrix.push({item:a,span:!1});d++,d>=this.colCount&&(d=0)}return this}.protect(),_positionItems:function(){var a,b,c,d,e,f,g=this.options.gutter,h=this.matrix,i=this.options.rtl?"right":"left",j=0,k=[],l=0,m={margin:0,position:"absolute"};for(d=0;d<this.colCount;d++)k.push(0);for(d=0,e=h.length;e>d;d++){if(a=h[d],b=a.span,(l>=this.colCount||b+l>this.colCount)&&(l=0,j=0),b){for(c=0,f=0;b>f;f++)k[l+f]>c&&(c=k[l+f]);for(m.top=c,m[i]=j,m.width=(this.colWidth+g)*b-g,a.item.setStyles(m).reveal(),f=0;b>f;f++)k[l+f]=a.item.getSize().y+g+c}j+=this.colWidth+g,l++}return this.element.setStyle("height",Math.max.apply(Math,k)),this}.protect(),onLoad:function(a){(!a||"load"===a.type&&a.target.complete||"error"===a.type&&!a.target.complete)&&this.imagesLoaded++,this.imagesLoaded===this.images.length&&this.render()},onResize:function(){this.refresh()}}),Toolkit.createComponent("matrix",function(a){return new Toolkit.Matrix(this,a)})}();!function(){"use strict";Toolkit.Modal=new Class({Extends:Toolkit.Component,Binds:["onSubmit"],blackout:null,drag:null,elementBody:null,options:{delegate:".js-modal",animation:"fade",ajax:!0,draggable:!1,blackout:!0,fullScreen:!1,stopScroll:!0,getContent:"data-modal",contentElement:".modal-inner",closeElement:".modal-close",closeEvent:".modal-event-close",submitEvent:".modal-event-submit",template:'<div class="modal"><div class="modal-outer"><div class="modal-handle"><div class="modal-inner"></div><button type="button" class="modal-close modal-event-close"><span class="x"></span></button></div></div></div>'},initialize:function(a,b){this.parent(b),this.nodes=a,this.createElement(),b=this.options,b.fullScreen&&(this.element.addClass(Toolkit.options.isPrefix+"fullscreen"),b.draggable=!1),this.elementBody=this.element.getElement(b.contentElement),b.blackout&&(this.blackout=Toolkit.Blackout.factory(),b.stopScroll&&this.blackout.addEvent("hide",function(a){a&&document.body.removeClass("no-scroll")}));var c={};c["clickout element"]="onHide",c["clickout nodes"]="onHide",c["keydown window"]="onKeydown",c["click "+b.delegate]="onShow",c["click element "+b.closeEvent]="onHide",c["click element "+b.submitEvent]="onSubmit",this.events=c,this.enable(),this.fireEvent("init")},hide:function(){return this.blackout&&this.blackout.hide(),this.parent()},position:function(a){return a===!0?this:(this.blackout&&this.blackout.hideLoader(),this.elementBody.set("html",a),this.fireEvent("load",a),this.element.reveal(),this.options.fullScreen&&this.element.getElement(this.options.contentElement).setStyle("min-height",window.getHeight()),this.fireEvent("show"),this)},show:function(a,b){var c=this.options,d=c.ajax;return b?d=!1:a&&(this.node=a,d=this.readOption(a,"ajax"),b=this.readValue(a,this.readOption(a,"getContent"))||a.get("href"),b&&b.match(/^#[a-z0-9_\-\.:]+$/i)&&(d=!1)),b?(this.blackout&&this.blackout.show(),c.stopScroll&&document.body.addClass("no-scroll"),d?this.cache[b]?this.position(this.cache[b]):this.requestData(b):this.position(b),this):this},onKeydown:function(a){"esc"===a.key&&this.element.isShown()&&this.hide()},onSubmit:function(a){a.preventDefault();var b=a.target,c=this.elementBody.getElement("form");if(c){this.fireEvent("submit",[b,c]);var d={url:c.get("action"),method:c.get("method").toUpperCase()};d.data=window.FormData?new FormData(c):c.toQueryString(),this.requestData(d)}}}),Toolkit.createComponent("modal",function(a){return new Toolkit.Modal(this,a)},!0)}();!function(){"use strict";Toolkit.Pin=new Class({Extends:Toolkit.Component,Binds:["onResize","onScroll"],viewport:null,elementSize:null,parentSize:null,elementTop:null,active:!0,options:{animation:"",location:"right",xOffset:0,yOffset:0,throttle:50,fixed:!1,calculate:!1,context:null,template:!1},initialize:function(a,b){this.parent(b),this.element=a,this.options=this.inheritOptions(this.options,a),a.addClass(Toolkit.options.vendor+"pin"),this.elementTop=a.getStyle("top").toInt();var c,d=this.options.throttle;this.events=c={"ready document":"calculate"},c["scroll:throttle("+d+") window"]="onScroll",c["resize:throttle("+d+") window"]="onResize",this.enable(),this.fireEvent("init")},calculate:function(){return this.viewport=window.getSize(),this.elementSize=this.element.getCoordinates(),this.parentSize=this.element.getParent(this.options.context).getCoordinates(),this.active=this.parentSize.height>this.elementSize.height,this},onResize:function(){this.calculate(),this.fireEvent("resize")},onScroll:function(){if(this.options.calculate&&this.calculate(),this.active&&this.isVisible()){var a=this.options,b=a.fixed,c=this.elementSize,d=this.elementTop,e=this.parentSize,f=window.getScroll(),g={},h=a.xOffset,i=0;if(f.y<e.top)return void this.element.removeProperty("style").removeClass(Toolkit.options.isPrefix+"pinned");var j=f.y+c.height,k=e.height+e.top;b?j>=k?(i="auto",g.position="absolute",g.bottom=0):(g.position="fixed",g.bottom="auto"):(g.position="absolute",i+=j>=k?e.height-c.height:f.y-e.top+a.yOffset,d&&d>i&&(i=d)),g[a.location]=h,g.top=i,this.element.setStyles(g).addClass(Toolkit.options.isPrefix+"pinned"),this.fireEvent("scroll")}}}),Toolkit.createComponent("pin",function(a){return new Toolkit.Pin(this,a)})}();!function(){"use strict";Toolkit.Tooltip=new Class({Extends:Toolkit.Component,Binds:["onFollow"],elementHead:null,elementBody:null,options:{delegate:".js-tooltip",mode:"hover",ajax:!1,follow:!1,position:"top-center",showLoading:!0,showTitle:!0,getTitle:"title",getContent:"data-tooltip",mouseThrottle:50,xOffset:0,yOffset:0,delay:0,titleElement:".tooltip-head",contentElement:".tooltip-body",template:'<div class="tooltip"><div class="tooltip-inner"><div class="tooltip-head"></div><div class="tooltip-body"></div></div><div class="tooltip-arrow"></div></div>'},runtime:{},initialize:function(a,b){this.parent(b),this.nodes=a,this.createElement(),b=this.options,this.elementHead=this.element.getElement(b.titleElement),this.elementBody=this.element.getElement(b.contentElement),this.element.removeClass(b.className);var c="data-"+this.className()+"-title";this.nodes.each(function(a){a.setProperty(c,a.get("title")).removeProperty("title")}),"title"===b.getTitle&&(b.getTitle=c);var d={};"click"===b.mode?(d["clickout element"]="hide",d["clickout "+b.delegate]="hide"):d["mouseleave "+b.delegate]="hide",d[b.mode+" "+b.delegate]="onShow",this.events=d,this.enable(),this.fireEvent("init")},hide:function(){var a=this.element.get("data-new-position")||this.runtime.position||this.options.position,b=this.runtime.className||this.options.className;return this.runtime={},this.element.removeClass(a).removeClass(b).removeProperty("data-mew-position"),this.parent()},position:function(a,b){var c=Object.keys(this.runtime).length?this.runtime:this.options;if(a===!0)return this;if(this.element.addClass(c.position).addClass(c.className),b=b||this.readValue(this.node,c.getTitle),b&&c.showTitle?this.elementHead.set("html",b).show():this.elementHead.hide(),a?this.elementBody.set("html",a).show():this.elementBody.hide(),this.fireEvent("load",a),c.follow){var d="mousemove:throttle("+c.mouseThrottle+")";this.node.removeEvent(d,this.onFollow).addEvent(d,this.onFollow),this.fireEvent("show")}else this.element.positionTo(c.position,this.node,{left:c.xOffset,top:c.yOffset}),window.setTimeout(function(){this.element.reveal(),this.fireEvent("show")}.bind(this),c.delay||0);return this},show:function(a,b,c){var d;return a?(this.node=a,this.runtime=d=this.inheritOptions(this.options,a),b=b||this.readValue(a,d.getContent)):this.runtime=d=this.options,b?(d.ajax?this.cache[b]?this.position(this.cache[b],c):(d.showLoading&&this.position(Toolkit.messages.loading),this.requestData(b)):this.position(b,c),this):this},onFollow:function(a){a.preventDefault();var b=this.runtime;this.element.positionTo(b.position,a,{left:b.xOffset,top:b.yOffset},!0).reveal()}}),Toolkit.createComponent("tooltip",function(a){return new Toolkit.Tooltip(this,a)},!0)}();!function(){"use strict";Toolkit.Popover=new Class({Extends:Toolkit.Tooltip,options:{delegate:".js-popover",getContent:"data-popover",titleElement:".popover-head",contentElement:".popover-body",template:'<div class="popover"><div class="popover-inner"><div class="popover-head"></div><div class="popover-body"></div></div><div class="popover-arrow"></div></div>'},initialize:function(a,b){b=b||{},b.mode="click",b.follow=!1,this.parent(a,b)}}),Toolkit.createComponent("popover",function(a){return new Toolkit.Popover(this,a)},!0)}();!function(){"use strict";Toolkit.Showcase=new Class({Extends:Toolkit.Component,Binds:["next","prev","onJump"],items:null,tabs:null,prevButton:null,nextButton:null,data:[],index:0,blackout:null,options:{delegate:".js-showcase",blackout:!0,stopScroll:!0,transition:300,gutter:50,getCategory:"data-showcase",getImage:"href",getTitle:"title",itemsElement:".showcase-items",tabsElement:".showcase-tabs",prevElement:".showcase-prev",nextElement:".showcase-next",closeEvent:".showcase-event-close",jumpEvent:".showcase-event-jump",prevEvent:".showcase-event-prev",nextEvent:".showcase-event-next",template:'<div class="showcase"><div class="showcase-inner"><ul class="showcase-items"></ul><ol class="showcase-tabs bullets"></ol><button type="button" class="showcase-prev showcase-event-prev"><span class="arrow-left"></span></button><button type="button" class="showcase-next showcase-event-next"><span class="arrow-right"></span></button><button type="button" class="showcase-close showcase-event-close"><span class="x"></span></button></div></div>'},initialize:function(a,b){this.parent(b),this.nodes=a,this.createElement(),Toolkit.hasTransition||(this.options.transition=1),b=this.options,this.items=this.element.getElement(b.itemsElement),this.tabs=this.element.getElement(b.tabsElement),this.prevButton=this.element.getElement(b.prevElement),this.nextButton=this.element.getElement(b.nextElement),b.gutter+=this.element.getHeight()-this.items.getHeight(),this.options.blackout&&(this.blackout=Toolkit.Blackout.factory());var c={};this.events=c={"clickout element":"hide","clickout nodes":"hide","swipe element":"onSwipe","keydown window":"onKeydown"},c["click "+b.delegate]="onShow",c["click "+b.closeEvent]="hide",c["click "+b.nextEvent]="next",c["click "+b.prevEvent]="prev",c["click "+b.jumpEvent]="onJump",this.enable(),this.fireEvent("init")},hide:function(){return this.blackout&&this.blackout.hide(),this.options.stopScroll&&document.body.removeClass("no-scroll"),this.parent(function(){this.element.removeClass(Toolkit.options.isPrefix+"single"),this.items.removeProperty("style").getElements("li").removeClass("show")}.bind(this)),this},jump:function(a){a=Number.from(a).bound(this.data.length);var b=this,c=this.options,d=this.element,e=this.items,f=e.getElements("li"),g=f[a],h=this.data,i=h[a];if(this.index=a,this.tabs){var j=this.tabs.getElements("a");j.removeClass(Toolkit.options.isPrefix+"active"),j[a].addClass(Toolkit.options.isPrefix+"active")}if(f.removeClass("show"),g.hasAttribute("data-width"))this._resize(g.get("data-width").toInt(),g.get("data-height").toInt()),setTimeout(function(){g.addClass("show"),b.position()},c.transition);else{d.addClass(Toolkit.options.isPrefix+"loading");var k=new Image;k.src=i.image,k.onload=function(){b._resize(this.width,this.height),g.set("data-width",this.width).set("data-height",this.height),i.title&&g.grab(new Element("div."+Toolkit.options.vendor+"showcase-caption").set("html",i.title)),setTimeout(function(){d.removeClass(Toolkit.options.isPrefix+"loading"),g.addClass("show").grab(k),b.position()},c.transition)}}return this.fireEvent("jump",a),this},next:function(){return this.jump(this.index+1),this},position:function(){return this.blackout&&this.blackout.hideLoader(),this.element.reveal(),this.fireEvent("show"),this},prev:function(){return this.jump(this.index-1),this},show:function(a){this.node=a,this.index=0,this.element.addClass(Toolkit.options.isPrefix+"loading");var b=this.inheritOptions(this.options,a),c=this.readValue,d=c(a,b.getCategory),e=[],f=0;if(d)for(var g,h=0,i=0;g=this.nodes[h];h++)c(g,b.getCategory)===d&&(g===a&&(f=i),e.push({title:c(g,b.getTitle),category:d,image:c(g,b.getImage)}),i++);else e.push({title:c(a,b.getTitle),category:d,image:c(a,b.getImage)});return this.blackout&&this.blackout.show(),b.stopScroll&&document.body.addClass("no-scroll"),this._buildItems(e),this.jump(f),this},_buildItems:function(a){this.data=a,this.items.empty(),this.tabs.empty();for(var b,c,d,e=0;d=a[e];e++)b=new Element("li"),b.inject(this.items),c=new Element("a").set("class",this.options.jumpEvent.substr(1)).set("href","javascript:;").set("data-index",e),b=new Element("li"),b.inject(this.tabs).grab(c);return a.length<=1&&this.element.addClass(Toolkit.options.isPrefix+"single"),this.fireEvent("load",a),this}.protect(),_resize:function(a,b){var c,d,e=window.getSize(),f=this.options.gutter;if(a+f>e.x){var g=e.x-2*f;c=a/b,d=a-g,a=g,b-=Math.round(d/c)}else if(b+f>e.y){var h=e.y-2*f;c=b/a,d=b-h,a-=Math.round(d/c),b=h}return this.items.setStyles({width:a,height:b}),this},onJump:function(a){a.preventDefault(),this.jump(a.target.get("data-index")||0)},onKeydown:function(a){if(this.isVisible())switch(["up","down","left","right"].contains(a.key)&&a.preventDefault(),a.key){case"esc":this.hide();break;case"up":this.jump(0);break;case"down":this.jump(-1);break;case"left":this.prev();break;case"right":this.next()}},onSwipe:function(a){"left"===a.direction?this.next():"right"===a.direction&&this.prev()}}),Toolkit.createComponent("showcase",function(a){return new Toolkit.Showcase(this,a)},!0)}();!function(){"use strict";Toolkit.Stalker=new Class({Extends:Toolkit.Component,Binds:["onScroll"],container:null,targets:[],markers:[],offsets:[],options:{target:"",targetBy:"href",marker:"",markBy:"id",threshold:50,throttle:50,onlyWithin:!0,applyToParent:!0},initialize:function(a,b){if(this.parent(b),this.element=a,this.container="auto"===a.getStyle("overflow")?a:window,!this.options.target||!this.options.marker)throw new Error("A marker and target is required");a.addClass(Toolkit.options.vendor+"stalker"),this.refresh();var c;this.events=c={"ready document":"onScroll"},c["scroll:throttle("+this.options.throttle+") container"]="onScroll",this.enable(),this.fireEvent("init")},activate:function(a){return this._stalk(a,"activate"),this},deactivate:function(a){return this._stalk(a,"deactivate"),this},refresh:function(){return"auto"===this.element.getStyle("overflow")&&this.element!==document.body&&(this.element.scrollTop=0),this.targets=$$(this.options.target).addClass(Toolkit.options.vendor+"stalker-target"),this.markers=$$(this.options.marker).addClass(Toolkit.options.vendor+"stalker-marker"),this.offsets=this.markers.getCoordinates(this.element),this},_stalk:function(a,b){var c=Toolkit.options.isPrefix;if("activate"!==b||!a.hasClass(c+"stalked")){var d=this.options.targetBy,e=this.options.markBy,f="activate"===b?"addClass":"removeClass",g=this.targets.filter(function(b){return b.get(d).replace("#","")===a.get(e)});a[f](c+"stalked"),this.options.applyToParent?g.getParent()[f](c+"active"):g[f](c+"active"),this.fireEvent(b,[a,g])}},onScroll:function(){var a=this.container.getScroll().y,b=this.markers,c=this.offsets,d=this.options.onlyWithin,e=this.options.threshold;b.each(function(b,f){var g=c[f],h=g.top-e,i=g.top+g.height+e;d&&a>=h&&i>=a||!d&&a>=h?this.activate(b):this.deactivate(b)}.bind(this)),this.fireEvent("scroll")}}),Toolkit.createComponent("stalker",function(a){return new Toolkit.Stalker(this,a)})}();!function(){"use strict";Toolkit.Tabs=new Class({Extends:Toolkit.Component,nav:null,sections:[],tabs:[],index:0,options:{ajax:!0,collapsible:!1,defaultIndex:0,persistState:!1,preventDefault:!0,loadFragment:!0,cookie:null,cookieDuration:30,getUrl:"href",navElement:".tabs-nav",sectionElement:".tabs-section",template:!1},initialize:function(a,b){this.parent(b),this.element=a,this.options=b=this.inheritOptions(this.options,a),b.cookie||(b.cookie=a.get("id")),this.nav=a.getElement(b.navElement),this.tabs=this.nav.getElements("ul > li > a"),this.tabs.each(function(a,b){a.set("data-index",b).removeClass(Toolkit.options.isPrefix+"active")}),this.sections=a.getElements(b.sectionElement),this.sections.conceal(),this.events[b.mode+" tabs"]="onShow","click"!==b.mode&&b.preventDefault&&(this.events["click tabs"]=function(a){a.preventDefault()}),this.enable(),this.fireEvent("init");var c=b.defaultIndex;if(b.persistState&&(c=Number.from(Cookie.read("toolkit.tabs."+b.cookie))),!c&&b.loadFragment&&location.hash){var d=this.tabs.filter(function(a){return a.get("href")===location.hash});d[0]&&(c=d[0].get("data-index"))}c&&this.tabs[c]||(c=0),this.jump(c)},hide:function(){return this.sections.conceal(),this.fireEvent("hide",this.node),this},jump:function(a){return this.show(this.tabs[a.bound(this.tabs.length)])},show:function(a){var b=a.get("data-index"),c=this.sections[b],d=this.options,e=Toolkit.options.isPrefix,f=this.readOption(a,"ajax"),g=this.readValue(a,this.readOption(a,"getUrl"));return f&&g&&"#"!==g.substr(0,1)&&!this.cache[g]&&this.requestData(g,function(){c.set("html",this._loadingTemplate()).addClass(e+"loading")}.bind(this),function(a){this.cache[g]=!0,this.fireEvent("load",a),c.set("html",a).removeClass(e+"loading")}.bind(this),function(){c.set("html",this._errorTemplate()).removeClass(e+"loading").addClass(Toolkit.options.hasPrefix+"failed")}.bind(this)),this.nav.getElements("ul > li").removeClass(e+"active"),b===this.index&&d.collapsible?c.isVisible()?c.conceal():(a.getParent().addClass(e+"active"),c.reveal()):(this.hide(),a.getParent().addClass(e+"active"),c.reveal()),d.persistState&&Cookie.write("toolkit.tabs."+d.cookie,b,{duration:d.cookieDuration}),this.index=b,this.node=a,this.fireEvent("show",a),this},onShow:function(a){(this.options.preventDefault||this.options.ajax&&"#"!==a.target.get("href").substr(0,1))&&a.preventDefault(),this.show(a.target)}}),Toolkit.createComponent("tabs",function(a){return new Toolkit.Tabs(this,a)})}();!function(){"use strict";Toolkit.TypeAhead=new Class({Extends:Toolkit.Component,Implements:[Cache],Binds:["source","rewind","onCycle","onFind","onLookup"],input:null,shadow:null,index:-1,items:[],term:"",timer:null,options:{source:[],minLength:1,itemLimit:15,throttle:250,prefetch:!1,shadow:!1,storage:"session",query:{},contentElement:"",template:'<div class="type-ahead"></div>',sorter:null,matcher:null,builder:null},initialize:function(a,b){if(this.parent(b),this.createElement(),this.options=b=this.inheritOptions(this.options,a),this.input=a,"input"!==a.get("tag"))throw new Error("TypeAhead must be initialized on an input field");if(a.set("autocomplete","off"),this.setStorage(b.storage),Object.each({sorter:"sort",matcher:"match",builder:"build"},function(a,c){if(b[c]!==!1){var d;d=null===b[c]||"function"!==typeOf(b[c])?this[a]:b[c],this.options[c]=d.bind(this)}}.bind(this)),b.prefetch&&"string"===typeOf(b.source)){var c=b.source;new Request.JSON({url:c,data:b.query,onSuccess:function(a){this.setCache(c,a)}.bind(this)}).get()}b.shadow&&(this.node=new Element("div."+Toolkit.options.vendor+"type-ahead-shadow").wraps(this.input),this.shadow=this.input.clone().addClass(Toolkit.options.isPrefix+"shadow").removeProperty("id").set("readonly",!0).inject(this.node,"bottom"),this.input.addClass("not-shadow")),this.events={"keyup input":"onLookup","keydown input":"onCycle","clickout element":"hide"},this.enable(),this.fireEvent("init")},build:function(a){var b=new Element("a",{href:"javascript:;"});return b.grab(new Element("span."+Toolkit.options.vendor+"type-ahead-title",{html:this.highlight(a.title)})),a.description&&b.grab(new Element("span."+Toolkit.options.vendor+"type-ahead-desc",{html:a.description})),b},hide:function(){return this.shadow&&this.shadow.set("value",""),this.parent()},highlight:function(a){for(var b,c=this.term.replace(/[\-\[\]\{\}()*+?.,\\^$|#]/g,"\\$&").split(" "),d=function(a){return'<mark class="'+Toolkit.options.vendor+'type-ahead-highlight">'+a+"</mark>"},e=0;b=c[e];e++)a=a.replace(new RegExp(b,"ig"),d);return a},lookup:function(a){return this.term=a,this.timer=setTimeout(this.onFind,this.options.throttle),this},match:function(a,b){return a.toLowerCase().indexOf(b.toLowerCase())>=0},position:function(){if(!this.items.length)return this.hide();var a=this.input.getCoordinates();return this.element.setPosition({x:a.left,y:a.top+a.height}),this.element.reveal(),this},rewind:function(){return this.index=-1,this.element.getElements("li").removeClass(Toolkit.options.isPrefix+"active"),this},select:function(a,b){this.index=a;var c=this.element.getElements("li");if(c.removeClass(Toolkit.options.isPrefix+"active"),a>=0){if(this.items[a]){var d=this.items[a];c[a].addClass(Toolkit.options.isPrefix+"active"),this.input.set("value",d.title),this.fireEvent(b||"select",[d,a])}}else this.input.set("value",this.term),this.fireEvent("reset");return this},sort:function(a){return a.sort(function(a,b){return a.title.localeCompare(b.title)})},source:function(a){if(!this.term.length||!a.length)return this.hide(),this;var b,c=this.options,d={_empty_:[]},e=new Element("ul");this.items=[],this.index=-1,"function"===typeOf(c.sorter)&&(a=c.sorter(a)),"function"===typeOf(c.matcher)&&(a=a.filter(function(a){return c.matcher(a.title,this.term)}.bind(this)));for(var f=0;b=a[f];f++)b.category?(d[b.category]||(d[b.category]=[]),d[b.category].push(b)):d._empty_.push(b);var g=[],h=0;return Object.each(d,function(a,d){var f=new Elements;"_empty_"!==d&&(g.push(null),f.push(new Element("li").addClass(Toolkit.options.vendor+"type-ahead-heading").grab(new Element("span",{text:d}))));for(var i,j=0;(b=a[j])&&!(h>=c.itemLimit);j++)i=c.builder(b),i.addEvents({mouseover:this.rewind,click:this.onSelect.pass(g.length,this)}),f.push(new Element("li").grab(i)),g.push(b),h++;f.inject(e)}.bind(this)),c.contentElement?this.element.getElement(c.contentElement).empty().grab(e):this.element.empty().grab(e),this.items=g,this.cache[this.term.toLowerCase()]=g.filter(function(a){return null!==a}),this.fireEvent("load"),this._shadow(),this.position(),this.fireEvent("show"),this},_shadow:function(){if(!this.shadow)return this;var a=this.input.get("value"),b=a.toLowerCase(),c="";if(this.cache[b]&&this.cache[b][0]){var d=this.cache[b][0].title;0===d.toLowerCase().indexOf(b)&&(c=a+d.substr(a.length,d.length-a.length))}return this.shadow.set("value",c),this}.protect(),onCycle:function(a){var b=this.items,c=b.length.limit(0,this.options.itemLimit);if(c&&this.isVisible()){switch(a.key){case"up":this.index-=b[this.index-1]?1:2,this.index<0&&(this.index=c);break;case"down":this.index+=b[this.index+1]?1:2,this.index>=c&&(this.index=-1);break;case"tab":a.preventDefault();for(var d=0;!this.items[d];)d++;this.index=d,this.hide();break;case"enter":this.hide();break;case"esc":this.index=-1,this.hide();break;default:return}this.shadow&&this.shadow.set("value",""),this.select(this.index,"cycle")}},onFind:function(){var a=this.term,b=this.options,c=typeOf(b.source);if(this.cache[a.toLowerCase()])this.source(this.cache[a.toLowerCase()]);else if("string"===c){var d=b.source,e=this.getCache(d);if(e)this.source(e);else{var f=b.query;f.term=a,new Request.JSON({url:d,data:f,onSuccess:this.source}).get()}}else if("array"===c)this.source(b.source);else{if("function"!==c)throw new Error("Invalid TypeAhead source type");var g=b.source.attempt([],this);g&&this.source(g)}},onLookup:function(a){if(!["up","down","esc","tab","enter"].contains(a.key)){window.clearTimeout(this.timer);var b=this.input.get("value").trim();b.length<this.options.minLength?(this.fireEvent("reset"),this.hide()):(this._shadow(),this.lookup(b))}},onSelect:function(a){this.select(a),this.hide()}}),Toolkit.createComponent("typeAhead",function(a){return new Toolkit.TypeAhead(this,a)})}();